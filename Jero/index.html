<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gu√≠a de Estudio: Neoclasicismo y Romanticismo (4¬∫ ESO)</title>
    <!-- Carga de Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Estilos base */
        body { font-family: 'Georgia', serif; }
        h1, h2, header p, nav h3 { font-family: 'Times New Roman', serif; }
        /* Clases personalizadas */
        .author-name { color: #78350f; }
        .work-title { color: #78350f; font-weight: 600; }
        strong.work-title { font-weight: 700; }
        em.work-title { font-style: italic; }
        /* Tablas Comparativas IA */
        .comparison-table th { background-color: #4b5563; color: white; padding: 0.75rem; text-align: center; }
        .comparison-table td { border: 1px solid #d4d4d8; padding: 0.75rem; text-align: center; }
        /* Respuestas Gemini */
        .gemini-answer { padding: 1.25rem; background-color: #eff6ff; border: 1px solid #bfdbfe; border-radius: 0.5rem; margin-top: 1.5rem; text-align: left; box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06); }
        .gemini-answer h4 { font-weight: 700; font-size: 1.125rem; margin-bottom: 0.75rem; color: #1e40af; text-align: left; font-family: 'Times New Roman', serif; }
        .gemini-answer pre { background-color: white; padding: 0.75rem; border-radius: 0.375rem; box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05); border: 1px solid #e5e7eb; font-size: 0.875rem; text-align: left; white-space: pre-wrap; overflow-x: auto; }
        .gemini-answer button { background-color: #4b5563; color: white; font-weight: 700; padding: 0.5rem 0.75rem; border-radius: 0.5rem; transition: background-color 200ms; font-size: 0.75rem; margin-top: 0.75rem; }
        .gemini-answer button:hover { background-color: #374151; }
        /* Estilo para mensaje API Key */
        .api-key-message { background-color: #fefce8; border: 1px solid #fef08a; color: #a16207; }
    </style>
</head>
<body class="bg-amber-50 leading-relaxed text-stone-800 text-base p-5">

    <!-- Contenedor Principal -->
    <div class="container mx-auto max-w-4xl p-6 md:p-12 bg-white shadow-xl rounded-lg border border-amber-200">

        <!-- Encabezado -->
        <header class="mb-12 text-center">
            <h1 class="text-4xl md:text-5xl font-bold text-amber-900 mb-3 text-center">Gu√≠a de Estudio: Neoclasicismo y Romanticismo</h1>
            <p class="text-lg text-stone-600 mt-3 text-center">Un viaje por la literatura espa√±ola del Siglo de las Luces y la √©poca de los sentimientos.</p>
        </header>

        <!-- Men√∫ de Navegaci√≥n R√°pida -->
        <nav class="bg-amber-100 border-b-2 border-amber-400 p-5 rounded-lg shadow-lg mb-12 sticky top-4 z-10">
            <h3 class="font-bold text-xl mb-4 text-amber-900 text-center">√çndice Tem√°tico</h3>
            <ul class="grid grid-cols-2 md:grid-cols-3 gap-3 text-center text-sm">
                <li><a href="#neoclasicismo" class="block p-2 rounded text-amber-900 hover:bg-white transition duration-200 font-semibold">1. El Siglo de las Luces</a></li>
                <li><a href="#prosa-neo" class="block p-2 rounded text-amber-900 hover:bg-white transition duration-200 font-semibold">2. La Prosa Ilustrada</a></li>
                <li><a href="#poesia-teatro-neo" class="block p-2 rounded text-amber-900 hover:bg-white transition duration-200 font-semibold">3. Poes√≠a y Teatro Neocl√°sicos</a></li>
                <li><a href="#romanticismo" class="block p-2 rounded text-amber-900 hover:bg-white transition duration-200 font-semibold">4. La Llegada del Romanticismo</a></li>
                <li><a href="#poesia-rom" class="block p-2 rounded text-amber-900 hover:bg-white transition duration-200 font-semibold">5. La Poes√≠a Rom√°ntica</a></li>
                <li><a href="#prosa-teatro-rom" class="block p-2 rounded text-amber-900 hover:bg-white transition duration-200 font-semibold">6. Prosa y Teatro Rom√°ntico</a></li>
                <li><a href="#textos" class="block p-2 rounded text-amber-900 hover:bg-white transition duration-200 font-semibold">7. Analizar Textos</a></li>
                <li><a href="#gemini-assistant" class="block p-2 rounded text-purple-700 hover:bg-white transition duration-200 font-bold">‚ú® Asistente IA</a></li>
                <li><a href="#podcast-generator-section" class="block p-2 rounded text-green-700 hover:bg-white transition duration-200 font-bold">üéß Podcast de Estudio</a></li>
            </ul>
        </nav>

        <!-- SECCI√ìN 1: NEOCLASICISMO -->
        <section id="neoclasicismo" class="mb-16 scroll-mt-24">
            <h2 class="text-3xl font-bold text-stone-700 mb-8 border-b-2 pb-3 border-amber-200 text-center">PARTE 1: El Neoclasicismo y el Siglo de las Luces (Siglo XVIII)</h2>
            <p class="text-left mb-6 text-base text-stone-700">Vamos a hablar del siglo XVIII. En Europa, esta √©poca estuvo marcada por la <strong>Ilustraci√≥n</strong>. Fue un movimiento cultural muy importante que quer√≠a acabar con la ignorancia usando el <strong>conocimiento</strong> y, sobre todo, la <strong>Raz√≥n</strong> (la capacidad de pensar l√≥gicamente). La gente de la Ilustraci√≥n pensaba que si se hac√≠an cambios en la ciencia, la econom√≠a, la pol√≠tica y la sociedad, se podr√≠a conseguir un futuro mejor, con m√°s <strong>progreso</strong>, <strong>justicia</strong> y <strong>libertad</strong>. Por eso, al siglo XVIII se le llama el <strong>Siglo de las Luces</strong>.</p>
            <p class="text-left mb-6 text-base text-stone-700">Aunque Espa√±a no pasaba por su mejor momento, las ideas de la Ilustraci√≥n tambi√©n llegaron aqu√≠. Hubo pensadores importantes y se crearon instituciones culturales que todav√≠a existen, como la <strong>Real Academia Espa√±ola (RAE)</strong>, la Real Academia de la Historia y la de Medicina. Esto muestra las ganas que ten√≠an los ilustrados de organizar y compartir el saber.</p>

            <h4 class="text-xl font-semibold text-stone-700 mt-10 mb-4 text-left pt-6 border-t border-dashed border-stone-300">¬øDe d√≥nde ven√≠an las ideas de la Ilustraci√≥n?</h4>
            <p class="text-left mb-6 text-base text-stone-700">La Ilustraci√≥n se bas√≥ en dos formas principales de pensar:</p>
            <p class="text-left mb-6 text-base text-stone-700">Por un lado, el <strong>Racionalismo</strong>, que dec√≠a que la <strong>Raz√≥n</strong> era la base de todo conocimiento verdadero. Pensaban que hab√≠a que dudar de todo y analizarlo con l√≥gica antes de aceptarlo.</p>
             <p class="text-left mb-6 text-base text-stone-700">Por otro lado, el <strong>Empirismo</strong>, que defend√≠a que todo conocimiento viene de la <strong>experiencia</strong>, de lo que vemos y tocamos. Cre√≠an que hab√≠a que <strong>observar</strong> las cosas, pensar una explicaci√≥n (hip√≥tesis) y luego hacer <strong>experimentos</strong> para comprobar si era verdad. Solo lo que se puede probar as√≠ es conocimiento real.</p>

            <h4 class="text-xl font-semibold text-stone-700 mt-10 mb-4 text-left pt-6 border-t border-dashed border-stone-300">Ideas Principales de la Ilustraci√≥n</h4>
            <p class="text-left mb-6 text-base text-stone-700">Juntando estas ideas y las ganas de mejorar las cosas, la Ilustraci√≥n se caracteriz√≥ por:</p>
             <p class="text-left mb-6 text-base text-stone-700">Confiar mucho en la <strong>Raz√≥n humana</strong> para entender el mundo y organizar la sociedad de forma m√°s justa.</p>
             <p class="text-left mb-6 text-base text-stone-700">Creer que la <strong>ciencia</strong>, con sus m√©todos de observar y experimentar, era el camino para el <strong>progreso</strong>.</p>
             <p class="text-left mb-6 text-base text-stone-700">El <strong>Enciclopedismo</strong>: la idea de reunir todo el saber humano en grandes libros (como la Enciclopedia) para que la gente aprendiera y dejara de ser ignorante.</p>
              <p class="text-left mb-6 text-base text-stone-700">Pensar que la <strong>cultura y la educaci√≥n</strong> eran s√∫per importantes para que la gente mejorara y fuera m√°s libre.</p>
              <p class="text-left mb-6 text-base text-stone-700">En pol√≠tica, se dio el <strong>Despotismo Ilustrado</strong>: los reyes ten√≠an todo el poder y hac√≠an reformas para ayudar al pueblo, pero sin dejar que el pueblo participara en las decisiones ("Todo para el pueblo, pero sin el pueblo").</p>

             <h4 class="text-xl font-semibold text-stone-700 mt-10 mb-4 text-left pt-6 border-t border-dashed border-stone-300">El Arte y la Literatura: El Neoclasicismo</h4>
            <p class="text-left mb-6 text-base text-stone-700">Todas estas ideas se reflejaron en el arte y la literatura con un estilo llamado <strong>Neoclasicismo</strong>. Era muy diferente al estilo exagerado del Barroco (la √©poca anterior) y segu√≠a las ideas de orden y utilidad de la Raz√≥n.</p>
            <p class="text-left mb-6 text-base text-stone-700">Se busc√≥ volver a <strong>imitar a los autores cl√°sicos</strong> de Grecia y Roma, porque se pensaba que ellos hab√≠an alcanzado la perfecci√≥n. Se valoraba m√°s seguir las reglas que ser original.</p>
            <p class="text-left mb-6 text-base text-stone-700">La <strong>Raz√≥n estaba por encima de los sentimientos</strong>. Por eso, no se escribi√≥ mucha poes√≠a que expresara emociones personales. Se crearon <strong>normas estrictas</strong> sobre c√≥mo escribir, sobre todo en el teatro.</p>
            <p class="text-left mb-6 text-base text-stone-700">Se <strong>rechazaba la fantas√≠a y la imaginaci√≥n</strong>. Las obras ten√≠an que ser <strong>veros√≠miles</strong>, es decir, cre√≠bles, l√≥gicas.</p>
            <p class="text-left mb-6 text-base text-stone-700">La literatura ten√≠a que ser <strong>√∫til</strong> para la sociedad, tener una <strong>finalidad did√°ctica</strong> (ense√±ar algo) y moral (mostrar lo que estaba bien y mal).</p>
            <p class="text-left mb-6 text-base text-stone-700">Se buscaba el <strong>"buen gusto"</strong>: claridad, orden, equilibrio, armon√≠a, sin exageraciones ni cosas vulgares.</p>

             <h4 class="text-xl font-semibold text-stone-700 mt-10 mb-4 text-left pt-6 border-t border-dashed border-stone-300">El Neoclasicismo en Espa√±a: Por Etapas</h4>
            <p class="text-left mb-6 text-base text-stone-700">El Neoclasicismo no lleg√≥ a Espa√±a de golpe, sino poco a poco:</p>
             <p class="text-left mb-6 text-base text-stone-700"><strong>Reacci√≥n contra el Barroco (Primera mitad s. XVIII):</strong> Se empez√≥ a criticar lo exagerado del Barroco y llegaron ideas de Francia. Se escrib√≠an sobre todo ensayos cr√≠ticos. Destacan <strong>Fray Benito Jer√≥nimo Feijoo</strong>.</p>
             <p class="text-left mb-6 text-base text-stone-700"><strong>Triunfo del Neoclasicismo (Mediados a finales s. XVIII):</strong> Las normas neocl√°sicas se imponen. La literatura busca ense√±ar usando la raz√≥n. Escriben autores importantes como <strong>Gaspar Melchor de Jovellanos</strong>, <strong>Leandro Fern√°ndez de Morat√≠n</strong>, los fabulistas <strong>Tom√°s de Iriarte</strong> y <strong>F√©lix Mar√≠a Samaniego</strong>, y tambi√©n <strong>Jos√© Cadalso</strong>.</p>
             <p class="text-left mb-6 text-base text-stone-700"><strong>Prerromanticismo (Finales s. XVIII):</strong> La gente empieza a cansarse de tantas reglas. Aparecen obras que muestran m√°s sentimientos y melancol√≠a, preparando el camino para el Romanticismo. <strong>Jos√© Cadalso</strong>, con <em class="work-title">Noches L√∫gubres</em>, es clave en esta etapa.</p>
        </section>

        <!-- SECCI√ìN 2: PROSA NEOCL√ÅSICA -->
        <section id="prosa-neo" class="mb-16 scroll-mt-24">
            <h2 class="text-3xl font-bold text-stone-700 mb-8 border-b-2 pb-3 border-amber-200 text-center">PARTE 2: La Prosa para Ense√±ar</h2>
            <p class="text-left mb-6 text-base text-stone-700">La prosa, especialmente el <strong>ensayo</strong> (escritos donde se reflexiona sobre un tema), fue la forma preferida por los ilustrados para explicar sus ideas, criticar la sociedad y ense√±ar.</p>

            <h3 class="text-2xl font-semibold text-amber-800 mt-12 mb-5 text-left pt-8 border-t border-amber-300"><span class="author-name">Fray Benito Jer√≥nimo Feijoo</span> (1676-1764)</h3>
            <p class="text-left mb-6 text-base text-stone-700">Fue uno de los ilustrados m√°s importantes de Espa√±a al principio. Quer√≠a modernizar el pa√≠s luchando contra las supersticiones y las ideas anticuadas usando la <strong>Raz√≥n</strong> y la <strong>experiencia</strong>.</p>
            <blockquote class="border-l-4 border-stone-400 pl-5 italic text-stone-600 my-6 text-lg">Quer√≠a perseguir errores y supersticiones y fomentar la filosof√≠a y la ciencia.</blockquote>
            <p class="text-left mb-6 text-base text-stone-700">Escrib√≠a de forma <strong>sencilla y clara</strong> para que mucha gente pudiera entenderle. Sus libros m√°s famosos son el <strong class="work-title">Teatro Cr√≠tico Universal</strong> y las <strong class="work-title">Cartas eruditas y curiosas</strong>. En ellos habla de much√≠simos temas (ciencia, historia, costumbres...) siempre buscando la verdad y usando la l√≥gica.</p>

            <h3 class="text-2xl font-semibold text-amber-800 mt-12 mb-5 text-left pt-8 border-t border-amber-300"><span class="author-name">Gaspar Melchor de Jovellanos</span> (1744-1811)</h3>
            <p class="text-left mb-6 text-base text-stone-700">Jovellanos fue un intelectual muy completo (escritor, pol√≠tico, economista...) que se preocup√≥ mucho por los problemas de Espa√±a, sobre todo los econ√≥micos.</p>
            <p class="text-left mb-6 text-base text-stone-700">Pensaba que la agricultura era muy importante para la riqueza del pa√≠s. En su <strong class="work-title">Informe sobre la Ley Agraria</strong>, explic√≥ los problemas del campo y propuso soluciones. Escrib√≠a de forma seria, elegante y con la intenci√≥n de ayudar a mejorar Espa√±a.</p>

            <h3 class="text-2xl font-semibold text-amber-800 mt-12 mb-5 text-left pt-8 border-t border-amber-300"><span class="author-name">Jos√© Cadalso</span> (1741-1782): Cr√≠tico y Sentimental</h3>
            <p class="text-left mb-6 text-base text-stone-700">Cadalso est√° entre la Ilustraci√≥n y el Romanticismo. En sus obras se ve la cr√≠tica de la Ilustraci√≥n, pero tambi√©n una nueva forma de sentir, m√°s triste y personal, que anuncia lo que vendr√° despu√©s.</p>
            <p class="text-left mb-6 text-base text-stone-700">En las <strong class="work-title">Cartas Marruecas</strong>, usa un truco: imagina que un viajero de Marruecos (Gazel) escribe cartas contando lo que ve en Espa√±a. As√≠, Cadalso puede criticar las costumbres, la pol√≠tica o el atraso del pa√≠s como si lo viera alguien de fuera, buscando siempre que las cosas mejoren.</p>
            <p class="text-left mb-6 text-base text-stone-700">Pero en <strong class="work-title">Noches L√∫gubres</strong>, Cadalso habla de sentimientos muy distintos. El ambiente es oscuro (noches, tumbas), y el protagonista (Tediato) est√° desesperado porque quiere desenterrar a su amada muerta. Explora el dolor y la muerte de una forma muy intensa, que ya no es neocl√°sica, sino que adelanta el <strong>Prerromanticismo</strong>.</p>
        </section>

        <!-- SECCI√ìN 3: POES√çA Y TEATRO NEOCL√ÅSICO -->
        <section id="poesia-teatro-neo" class="mb-16 scroll-mt-24">
            <h2 class="text-3xl font-bold text-stone-700 mb-8 border-b-2 pb-3 border-amber-200 text-center">PARTE 3: La Poes√≠a y el Teatro Neocl√°sicos</h2>
            <p class="text-left mb-6 text-base text-stone-700">La poes√≠a y el teatro del siglo XVIII tambi√©n siguieron las ideas neocl√°sicas de orden y ense√±anza.</p>

            <h4 class="text-xl font-semibold text-stone-700 mt-10 mb-4 text-left pt-6 border-t border-dashed border-stone-300">La Poes√≠a Neocl√°sica: Para Ense√±ar</h4>
            <p class="text-left mb-6 text-base text-stone-700">Como se daba m√°s importancia a la raz√≥n que a los sentimientos, la poes√≠a que expresaba emociones personales no fue muy popular. La poes√≠a neocl√°sica serv√≠a sobre todo para <strong>educar y criticar los vicios</strong>.</p>
            <p class="text-left mb-6 text-base text-stone-700">El tipo de poes√≠a que m√°s encajaba con esto era la <strong>F√°bula</strong>. Son historias cortas, normalmente con animales que hablan, que terminan con una ense√±anza moral (la moraleja). Eran perfectas para el af√°n did√°ctico de la √©poca.</p>
             <p class="text-left mb-6 text-base text-stone-700">En Espa√±a destacaron dos autores de f√°bulas: <strong>Tom√°s de Iriarte</strong> (con sus <strong class="work-title">F√°bulas literarias</strong>, que a veces hablaban sobre c√≥mo escribir bien) y <strong>F√©lix Mar√≠a de Samaniego</strong> (con sus <strong class="work-title">F√°bulas en verso castellano</strong>, que adaptaban historias cl√°sicas y se hicieron muy populares).</p>
            <p class="text-left mb-6 text-base text-stone-700">Tambi√©n hubo algo de poes√≠a que hablaba de forma idealizada de la vida sencilla en el campo o del amor cort√©s, con un toque de melancol√≠a.</p>

            <h4 class="text-xl font-semibold text-stone-700 mt-10 mb-4 text-left pt-6 border-t border-dashed border-stone-300">El Teatro Neocl√°sico: Orden en el Escenario</h4>
            <p class="text-left mb-6 text-base text-stone-700">Los ilustrados pensaban que el teatro era como una escuela para ense√±ar al pueblo buenos valores. Por eso, quisieron quitarle lo exagerado y desordenado del teatro barroco e impusieron un teatro basado en la raz√≥n y las normas cl√°sicas.</p>
            <p class="text-left mb-6 text-base text-stone-700">Las <strong>caracter√≠sticas</strong> principales de este teatro eran:</p>
            <p class="text-left mb-6 text-base text-stone-700">Tener una clara <strong>intenci√≥n did√°ctica</strong> (ense√±ar algo moral).</p>
            <p class="text-left mb-6 text-base text-stone-700"><strong>Imitar a los autores cl√°sicos</strong> griegos, romanos y franceses.</p>
            <p class="text-left mb-6 text-base text-stone-700">Respetar la <strong>Regla de las Tres Unidades</strong>: una sola <strong>acci√≥n</strong> (historia principal), que ocurriera en un <strong>tiempo</strong> corto (un d√≠a m√°s o menos) y en un solo <strong>lugar</strong> (escenario).</p>
            <p class="text-left mb-6 text-base text-stone-700"><strong>Separar los g√©neros</strong>: la tragedia para temas serios y personajes importantes, la comedia para temas normales y gente com√∫n, sin mezclarlos.</p>
            <p class="text-left mb-6 text-base text-stone-700">Buscar la <strong>verosimilitud</strong> (que fuera cre√≠ble) y el <strong>decoro</strong> (que fuera apropiado, sin violencia ni cosas feas en escena).</p>

            <h3 class="text-2xl font-semibold text-amber-800 mt-12 mb-5 text-left pt-8 border-t border-amber-300"><span class="author-name">Leandro Fern√°ndez de Morat√≠n</span> (1760-1828)</h3>
            <p class="text-left mb-6 text-base text-stone-700">Morat√≠n es el autor m√°s importante del teatro neocl√°sico espa√±ol. Supo seguir las reglas, pero tambi√©n observar y criticar la sociedad de su √©poca en sus comedias.</p>
            <p class="text-left mb-6 text-base text-stone-700">Sus obras m√°s famosas son <strong class="work-title">La comedia nueva o El caf√©</strong> (que se re√≠a del mal teatro) y, sobre todo, <strong class="work-title">El s√≠ de las ni√±as</strong>.</p>
            <p class="text-left mb-6 text-base text-stone-700"><strong class="work-title">El s√≠ de las ni√±as</strong> es un ejemplo perfecto de comedia neocl√°sica. Cumple las tres unidades (todo pasa en una posada en menos de un d√≠a). La obra critica los <strong>matrimonios concertados</strong>, donde los padres casaban a sus hijas sin preguntarles si quer√≠an, y defiende que la educaci√≥n debe basarse en la sinceridad. La protagonista, Do√±a Francisca (Paquita), es obligada a casarse con un hombre mayor (Don Diego), pero ella est√° enamorada de otro (Don Carlos, que resulta ser sobrino de Don Diego). Al final, la sensatez de Don Diego representa el triunfo de la raz√≥n ilustrada.</p>
        </section>

        <!-- SECCI√ìN 4: ROMANTICISMO -->
        <section id="romanticismo" class="mb-16 scroll-mt-24">
            <h2 class="text-3xl font-bold text-stone-700 mb-8 border-b-2 pb-3 border-amber-200 text-center">PARTE 4: La Llegada del Romanticismo (Primera Mitad Siglo XIX)</h2>
            <p class="text-left mb-6 text-base text-stone-700">El <strong>Romanticismo</strong> aparece como una reacci√≥n contra el Neoclasicismo. Si el Neoclasicismo se basaba en la Raz√≥n, el Romanticismo se centrar√° en el <strong>Sentimiento</strong>. Si uno buscaba reglas, el otro buscar√° la <strong>Libertad</strong>. Si uno quer√≠a ense√±ar con claridad, el otro explorar√° los misterios del <strong>"Yo"</strong> (la propia persona) y la fuerza de la <strong>Imaginaci√≥n</strong>.</p>

            <h4 class="text-xl font-semibold text-stone-700 mt-10 mb-4 text-left pt-6 border-t border-dashed border-stone-300">El Romanticismo Tarda en Llegar a Espa√±a</h4>
            <p class="text-left mb-6 text-base text-stone-700">En Espa√±a, el Romanticismo lleg√≥ m√°s tarde que en otros sitios por la complicada situaci√≥n del pa√≠s a principios del siglo XIX: la <strong>guerra contra Napole√≥n</strong> (desde 1808), la lucha por la independencia, la creaci√≥n de la <strong>Constituci√≥n de C√°diz de 1812 ("La Pepa")</strong> que trajo ideas liberales, y luego la vuelta al <strong>poder absoluto</strong> del rey Fernando VII. Este rey persigui√≥ a los liberales, y muchos tuvieron que irse al <strong>exilio</strong> (la "D√©cada Ominosa"). El Romanticismo triunf√≥ en Espa√±a sobre <strong>1833</strong>, cuando muri√≥ el rey y <strong>volvieron los exiliados</strong>, trayendo las nuevas ideas de Europa.</p>

            <h4 class="text-xl font-semibold text-stone-700 mt-10 mb-4 text-left pt-6 border-t border-dashed border-stone-300">¬øC√≥mo Eran los Rom√°nticos?</h4>
            <p class="text-left mb-6 text-base text-stone-700">El Romanticismo es una forma de sentir y ver la vida, que se nota en el arte y la literatura por estas caracter√≠sticas:</p>
             <p class="text-left mb-6 text-base text-stone-700"><strong>Subjetivismo y culto al "Yo":</strong> Lo m√°s importante es lo que siente y piensa cada persona: sus emociones, sue√±os, miedos...</p>
             <p class="text-left mb-6 text-base text-stone-700"><strong>Ansia de Libertad:</strong> Quer√≠an ser libres de todas las normas: sociales, morales y art√≠sticas. Por eso, <strong>rompieron con las reglas neocl√°sicas</strong>, buscaron ser <strong>originales</strong> y <strong>mezclaron</strong> g√©neros y estilos sin miedo.</p>
             <p class="text-left mb-6 text-base text-stone-700"><strong>Individualismo y Nacionalismo:</strong> Se interesaron por lo propio de cada pueblo: sus <strong>tradiciones</strong>, su <strong>historia</strong> (sobre todo la <strong>Edad Media</strong>), sus <strong>leyendas</strong>...</p>
             <p class="text-left mb-6 text-base text-stone-700"><strong>Tristeza y Desenga√±o ("Mal del Siglo"):</strong> Sent√≠an que sus ideales chocaban con la realidad, y eso les causaba <strong>frustraci√≥n, melancol√≠a</strong> y pesimismo.</p>
             <p class="text-left mb-6 text-base text-stone-700"><strong>Rebeld√≠a o Evasi√≥n:</strong> Para escapar de esa tristeza, se rebelaban contra las normas o se "escapaban" (<strong>evasi√≥n</strong>) imaginando el pasado, lugares ex√≥ticos o cosas sobrenaturales.</p>
             <p class="text-left mb-6 text-base text-stone-700"><strong>Nueva Visi√≥n de la Naturaleza:</strong> Ve√≠an la naturaleza como un reflejo de sus sentimientos. Prefer√≠an paisajes <strong>salvajes, misteriosos</strong>, como tormentas, noches, ruinas...</p>
              <p class="text-left mb-6 text-base text-stone-700"><strong>El Artista como Genio:</strong> Pensaban que el artista era alguien especial, con mucha sensibilidad, <strong>imaginaci√≥n</strong> y <strong>pasi√≥n</strong>.</p>

            <div class="bg-yellow-50 border-l-4 border-yellow-400 text-yellow-900 p-5 rounded-md my-8 shadow-sm text-left text-base">
                 <h4 class="text-xl font-semibold text-stone-700 mt-0 mb-4 text-left pt-0 border-t-0">Neoclasicismo vs. Romanticismo: Las Diferencias Clave</h4>
                 <p class="text-left mb-6 text-base text-yellow-900">El Romanticismo es lo contrario al Neoclasicismo. Donde uno pon√≠a <strong>Raz√≥n</strong>, el otro pone <strong>Sentimiento</strong>. Donde uno pon√≠a <strong>Normas</strong>, el otro pone <strong>Libertad</strong>. Si uno quer√≠a <strong>Educar</strong>, el otro busca <strong>Emocionar</strong>. La confianza neocl√°sica se convierte en <strong>Pesimismo</strong> rom√°ntico. El ensayo deja paso a la <strong>Poes√≠a</strong> y al <strong>Teatro (drama)</strong>.</p>
                 <table class="min-w-full rounded-lg overflow-hidden my-6 border border-amber-300 shadow">
                     <thead>
                        <tr>
                            <th class="p-4 border border-amber-200 text-center align-middle text-sm bg-amber-800 text-white font-semibold uppercase tracking-wider">Neoclasicismo (s. XVIII)</th>
                            <th class="p-4 border border-amber-200 text-center align-middle text-sm bg-amber-800 text-white font-semibold uppercase tracking-wider">Romanticismo (s. XIX)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="bg-amber-50"><td class="p-4 border border-amber-200 text-center align-middle text-sm">Raz√≥n</td><td class="p-4 border border-amber-200 text-center align-middle text-sm">Sentimiento / Intuici√≥n</td></tr>
                        <tr class="bg-white"><td class="p-4 border border-amber-200 text-center align-middle text-sm">Normas, Reglas (3 unidades)</td><td class="p-4 border border-amber-200 text-center align-middle text-sm">Libertad, Mezcla</td></tr>
                        <tr class="bg-amber-50"><td class="p-4 border border-amber-200 text-center align-middle text-sm">Didactismo (Educar)</td><td class="p-4 border border-amber-200 text-center align-middle text-sm">Emoci√≥n (Conmover)</td></tr>
                        <tr class="bg-white"><td class="p-4 border border-amber-200 text-center align-middle text-sm">Claridad, Buen Gusto</td><td class="p-4 border border-amber-200 text-center align-middle text-sm">Subjetividad, Contrastes (Bello/Grotesco)</td></tr>
                        <tr class="bg-amber-50"><td class="p-4 border border-amber-200 text-center align-middle text-sm">Optimismo, Confianza</td><td class="p-4 border border-amber-200 text-center align-middle text-sm">Pesimismo, Desenga√±o</td></tr>
                        <tr class="bg-white"><td class="p-4 border border-amber-200 text-center align-middle text-sm">Ensayo</td><td class="p-4 border border-amber-200 text-center align-middle text-sm">Poes√≠a, Teatro (Drama)</td></tr>
                    </tbody>
                 </table>
            </div>
        </section>

        <!-- SECCI√ìN 5: POES√çA ROM√ÅNTICA -->
        <section id="poesia-rom" class="mb-16 scroll-mt-24">
            <h2 class="text-3xl font-bold text-stone-700 mb-8 border-b-2 pb-3 border-amber-200 text-center">PARTE 5: La Poes√≠a Rom√°ntica: El Coraz√≥n Habla</h2>
            <p class="text-left mb-6 text-base text-stone-700">La poes√≠a fue la forma perfecta para que los rom√°nticos expresaran todos sus sentimientos. La importancia del "yo", la emoci√≥n y las ganas de probar cosas nuevas encajaban muy bien con el verso.</p>

            <h4 class="text-xl font-semibold text-stone-700 mt-10 mb-4 text-left pt-6 border-t border-dashed border-stone-300">Caracter√≠sticas Generales</h4>
            <p class="text-left mb-6 text-base text-stone-700">La poes√≠a rom√°ntica espa√±ola es muy personal y emotiva.</p>
             <p class="text-left mb-6 text-base text-stone-700">Los temas m√°s comunes son: el <strong>amor apasionado</strong> (que muchas veces acaba mal), la <strong>libertad</strong>, la <strong>rebeld√≠a</strong>, la <strong>angustia</strong> por la vida, la <strong>soledad</strong>, la <strong>muerte</strong>, y a veces la <strong>cr√≠tica social</strong>.</p>
             <p class="text-left mb-6 text-base text-stone-700">Aparecen <strong>escenarios t√≠picamente rom√°nticos</strong>: noches oscuras, cementerios, ruinas, paisajes naturales salvajes (mar, monta√±as, tormentas...) que reflejan c√≥mo se siente el poeta.</p>
             <p class="text-left mb-6 text-base text-stone-700">En la forma, buscaban la <strong>libertad</strong>: romp√≠an las reglas de la m√©trica cl√°sica y usaban la <strong>polimetr√≠a</strong> (mezclar distintos tipos de versos y estrofas) para expresarse mejor.</p>
             <p class="text-left mb-6 text-base text-stone-700">Usaban muchos <strong>recursos para crear emoci√≥n</strong>: exclamaciones (¬°!), interrogaciones (¬ø?), llamadas directas a alguien (ap√≥strofes).</p>
             <p class="text-left mb-6 text-base text-stone-700">Tambi√©n usaban figuras como repeticiones (an√°foras), frases parecidas (paralelismos), contrarios (ant√≠tesis), comparaciones e im√°genes con significado simb√≥lico.</p>

            <h4 class="text-xl font-semibold text-stone-700 mt-10 mb-4 text-left pt-6 border-t border-dashed border-stone-300">Tipos de Poes√≠a Rom√°ntica y Poetas Clave</h4>
            <p class="text-left mb-6 text-base text-stone-700">Podemos distinguir dos etapas o tipos:</p>
            
            <h5 class="text-lg font-semibold text-stone-800 mt-8 mb-3 text-left">1. Primer Romanticismo (Poes√≠a Exaltada y que Cuenta Historias)</h5>
            <p class="text-left mb-6 text-base text-stone-700">Es la poes√≠a m√°s exagerada y en√©rgica (hacia 1833-1844). A menudo cuenta historias largas (poes√≠a narrativa) sobre temas hist√≥ricos, leyendas o sobre la libertad, usando personajes rebeldes.</p>
            
            <h5 class="text-lg font-semibold text-amber-900 mt-8 mb-3 text-left"><span class="author-name">Jos√© de Espronceda</span> (1808-1842)</h5>
            <p class="text-left mb-6 text-base text-stone-700">Es el poeta m√°s representativo de esta etapa. Vivi√≥ una vida intensa y defendi√≥ las ideas liberales. En sus famosas <strong>Canciones</strong>, presenta a <strong>personajes marginados</strong> (pirata, mendigo, condenado a muerte...) como s√≠mbolos de libertad total contra las normas sociales. La <strong class="work-title">"Canci√≥n del Pirata"</strong> es un ejemplo perfecto. Tambi√©n escribi√≥ poemas largos como <strong class="work-title">El estudiante de Salamanca</strong> (leyenda) y <strong class="work-title">El diablo mundo</strong> (m√°s filos√≥fico).</p>
            

            <h5 class="text-lg font-semibold text-stone-800 mt-8 mb-3 text-left">2. Romanticismo Tard√≠o o Postromanticismo (Poes√≠a √çntima)</h5>
            <p class="text-left mb-6 text-base text-stone-700">A partir de mitad de siglo, la poes√≠a se vuelve m√°s <strong>tranquila, personal y sentimental</strong>. Los poemas son m√°s cortos, sencillos y musicales, y hablan de los sentimientos m√°s √≠ntimos.</p>

            <h5 class="text-lg font-semibold text-amber-900 mt-8 mb-3 text-left"><span class="author-name">Gustavo Adolfo B√©cquer</span> (1836-1870)</h5>
            <p class="text-left mb-6 text-base text-stone-700">Es s√∫per importante, considerado el primer poeta moderno espa√±ol. Sus <strong class="work-title">Rimas</strong> son poemas cortos, claros y muy musicales. Hablan con mucha sensibilidad del amor (desde las ganas hasta la p√©rdida), de lo r√°pido que pasa la belleza, del misterio de escribir poes√≠a y de la angustia por la soledad y la muerte.</p>
            

            <h5 class="text-lg font-semibold text-amber-900 mt-8 mb-3 text-left"><span class="author-name">Rosal√≠a de Castro</span> (1837-1885)</h5>
            <p class="text-left mb-6 text-base text-stone-700">Una poeta fundamental, escribi√≥ en gallego y en castellano. Su poes√≠a est√° llena de tristeza ("saudade"), dolor personal, preocupaci√≥n por las injusticias (como la gente que ten√≠a que irse de Galicia a buscar trabajo) y tiene una visi√≥n femenina muy moderna. Sus obras m√°s importantes son <strong class="work-title">Cantares gallegos</strong>, <strong class="work-title">Follas novas</strong> (en gallego) y <strong class="work-title">En las orillas del Sar</strong> (en castellano).</p>
            

        </section>

        <!-- SECCI√ìN 6: PROSA Y TEATRO ROM√ÅNTICO -->
        <section id="prosa-teatro-rom" class="mb-16 scroll-mt-24">
            <h2 class="text-3xl font-bold text-stone-700 mb-8 border-b-2 pb-3 border-amber-200 text-center">PARTE 6: La Prosa Cr√≠tica y el Teatro Apasionado</h2>
            <p class="text-left mb-6 text-base text-stone-700">El esp√≠ritu rom√°ntico tambi√©n se vio en la prosa, sobre todo en el periodismo cr√≠tico y en las historias sobre el pasado. Adem√°s, el teatro cambi√≥ por completo con dramas llenos de pasi√≥n.</p>

            <h4 class="text-xl font-semibold text-stone-700 mt-10 mb-4 text-left pt-6 border-t border-dashed border-stone-300">La Prosa Rom√°ntica</h4>
            <p class="text-left mb-6 text-base text-stone-700">Aunque la novela triunfar√≠a m√°s tarde (con el Realismo), en el Romanticismo se escribieron:</p>
            <p class="text-left mb-6 text-base text-stone-700"><strong>Novela Hist√≥rica:</strong> Historias ambientadas en la Edad Media, vista de forma idealizada. Ejemplos: <strong class="work-title">El doncel de don Enrique el Doliente</strong> (Larra).</p>
             <p class="text-left mb-6 text-base text-stone-700"><strong>Leyendas:</strong> Historias cortas con misterio y elementos sobrenaturales. B√©cquer fue el maestro con sus <strong class="work-title">Leyendas</strong>.</p>
              <p class="text-left mb-6 text-base text-stone-700"><strong>Periodismo de Costumbres (Costumbrismo):</strong> Art√≠culos que describ√≠an y criticaban la forma de vida, la sociedad y la pol√≠tica.</p>

            <h5 class="text-lg font-semibold text-amber-900 mt-8 mb-3 text-left"><span class="author-name">Mariano Jos√© de Larra ("F√≠garo")</span> (1809-1837)</h5>
            <p class="text-left mb-6 text-base text-stone-700">Larra es la figura m√°s importante de la prosa rom√°ntica, un <strong>periodista incre√≠ble</strong>, considerado el precursor del periodismo moderno.</p>
            <p class="text-left mb-6 text-base text-stone-700">En sus <strong>art√≠culos</strong> (firmados como "F√≠garo"), analiz√≥ con <strong>inteligencia y mucha iron√≠a</strong> (burla fina) la Espa√±a de su √©poca: la pol√≠tica, la sociedad, las costumbres... Era un liberal que se sent√≠a frustrado por el atraso y la falsedad que ve√≠a. Escrib√≠a de forma <strong>clara, directa y cr√≠tica</strong>. Muchos de sus art√≠culos, como <strong class="work-title">"Vuelva usted ma√±ana"</strong> o <strong class="work-title">"El castellano viejo"</strong>, siguen siendo actuales. Se suicid√≥ muy joven, lo que lo convirti√≥ en una figura m√≠tica del Romanticismo.</p>

            <h4 class="text-xl font-semibold text-stone-700 mt-10 mb-4 text-left pt-6 border-t border-dashed border-stone-300">El Teatro Rom√°ntico: ¬°Libertad en Escena!</h4>
            <p class="text-left mb-6 text-base text-stone-700">El teatro fue el g√©nero que m√°s cambi√≥ con el Romanticismo. Fue una <strong>rebeli√≥n contra las reglas fr√≠as del Neoclasicismo</strong> y una vuelta a la libertad y la emoci√≥n del teatro barroco, pero con un toque diferente.</p>
            <p class="text-left mb-6 text-base text-stone-700">Las <strong>claves</strong> de este nuevo teatro fueron:</p>
             <p class="text-left mb-6 text-base text-stone-700"><strong>Rechazo total de las reglas neocl√°sicas:</strong> No m√°s <strong>regla de las tres unidades</strong>, se <strong>mezclaban g√©neros</strong> (naci√≥ el <strong>Drama</strong>, que mezcla tragedia y comedia), se combinaba <strong>verso y prosa</strong>, y se usaba la <strong>polimetr√≠a</strong> (versos de distintas medidas).</p>
             <p class="text-left mb-6 text-base text-stone-700">Las obras se divid√≠an en <strong>cinco actos</strong>.</p>
             <p class="text-left mb-6 text-base text-stone-700">Los <strong>temas</strong> principales eran <strong>amores apasionados y prohibidos</strong>, el <strong>honor</strong>, la <strong>venganza</strong>, el <strong>destino tr√°gico</strong> (fatalidad) y la lucha por la <strong>libertad</strong>.</p>
             <p class="text-left mb-6 text-base text-stone-700">Los <strong>personajes</strong> eran <strong>h√©roes rebeldes</strong>, marcados por un destino triste, que viv√≠an sus pasiones al m√°ximo y desafiaban a todos. Las hero√≠nas tambi√©n eran fuertes y decididas. El final sol√≠a ser <strong>tr√°gico</strong>.</p>
             <p class="text-left mb-6 text-base text-stone-700">La <strong>escenograf√≠a</strong> (decorados) buscaba impactar: ambientes nocturnos, tumbas, escenarios sobrenaturales...</p>
             <p class="text-left mb-6 text-base text-stone-700">La <strong>finalidad</strong> era <strong>emocionar</strong>, conmover al espectador.</p>

            <h5 class="text-lg font-semibold text-amber-900 mt-8 mb-3 text-left"><span class="author-name">Duque de Rivas (√Ångel de Saavedra)</span> (1791-1865)</h5>
            <p class="text-left mb-6 text-base text-stone-700">Su obra <strong class="work-title">Don √Ålvaro o la fuerza del sino</strong> (1835) marc√≥ el triunfo del teatro rom√°ntico. Es un ejemplo perfecto del g√©nero, centrado en la <strong>fatalidad</strong>: el h√©roe no puede escapar de su destino tr√°gico.</p>

            <h5 class="text-lg font-semibold text-amber-900 mt-8 mb-3 text-left"><span class="author-name">Jos√© Zorrilla</span> (1817-1893)</h5>
            <p class="text-left mb-6 text-base text-stone-700">Fue el autor de teatro m√°s famoso de la √©poca. Su <strong class="work-title">Don Juan Tenorio</strong> (1844) fue un √©xito incre√≠ble y todav√≠a se representa hoy.</p>
            <p class="text-left mb-6 text-base text-stone-700">Zorrilla cogi√≥ el personaje de Don Juan, el seductor, pero lo hizo rom√°ntico: rebelde, lleno de vida, desafiante, pero capaz de enamorarse de verdad de Do√±a In√©s. La obra mezcla aventura, poes√≠a y cosas sobrenaturales. Lo m√°s importante es el final: este Don Juan <strong>se salva del infierno gracias al amor de Do√±a In√©s</strong>, un final muy rom√°ntico.</p>
        </section>

         <!-- SECCI√ìN 7: AN√ÅLISIS TEXTUAL -->
         <section id="textos" class="mb-16 scroll-mt-24">
             <h2 class="text-3xl font-bold text-stone-700 mb-8 border-b-2 pb-3 border-amber-200 text-center">PARTE 7: Claves para Analizar Textos</h2>
             <p class="text-left mb-6 text-base text-stone-700">Es importante saber c√≥mo se organiza un texto y qu√© quiere decir, ya sea un texto expositivo (que informa) o uno m√°s personal como los rom√°nticos.</p>

             <h4 class="text-xl font-semibold text-stone-700 mt-10 mb-4 text-left pt-6 border-t border-dashed border-stone-300">Entender los Textos Expositivos</h4>
             <p class="text-left mb-6 text-base text-stone-700">Recuerda: estos textos quieren <strong>informar</strong> de forma <strong>objetiva</strong> (sin dar opiniones personales), <strong>clara</strong> y <strong>precisa</strong>. Pueden ser <strong>divulgativos</strong> (para todo el mundo) o <strong>especializados</strong> (para expertos, con palabras t√©cnicas). Normalmente tienen <strong>introducci√≥n, desarrollo y conclusi√≥n</strong>.</p>

             <h4 class="text-xl font-semibold text-stone-700 mt-10 mb-4 text-left pt-6 border-t border-dashed border-stone-300">Analizar la Coherencia (Que el Texto Tenga Sentido)</h4>
             <p class="text-left mb-6 text-base text-stone-700">Para ver si un texto es coherente (si tiene sentido y las ideas est√°n bien conectadas), hacemos varias cosas:</p>
              <p class="text-left mb-6 text-base text-stone-700"><strong>Sacar el Tema:</strong> Es la <strong>idea principal</strong> de todo el texto. Hay que decirlo en pocas palabras (10-12), de forma precisa y sin usar verbos si es posible. Por ejemplo: <em>"La preocupaci√≥n por los sueldos bajos de los j√≥venes espa√±oles hoy en d√≠a."</em></p>
              <p class="text-left mb-6 text-base text-stone-700"><strong>Hacer un Resumen:</strong> Contar lo m√°s <strong>importante</strong> del texto (m√°s o menos una cuarta parte), <strong>con tus palabras</strong>, hablando en <strong>3¬™ persona</strong> (√©l/ella/ellos), de forma <strong>objetiva</strong> y sin detalles poco importantes (ejemplos, an√©cdotas...).</p>
              <p class="text-left mb-6 text-base text-stone-700"><strong>Ver la Estructura:</strong> Fijarse en c√≥mo est√°n organizadas las ideas. Miramos la estructura <strong>externa</strong> (c√≥mo se divide en <strong>p√°rrafos</strong>) y la <strong>interna</strong> (c√≥mo se ordenan las ideas l√≥gicamente). En la interna, buscamos la introducci√≥n, el desarrollo y la conclusi√≥n, y vemos cu√°les son las <strong>ideas principales y secundarias</strong>. Tambi√©n podemos ver d√≥nde est√° la <strong>Tesis</strong> (la idea principal que defiende el autor): si est√° al <strong>principio</strong> (estructura <strong>analizante/deductiva</strong>), al <strong>final</strong> (<strong>sintetizante/inductiva</strong>) o al principio y al final (encuadrada).</p>

             <h4 class="text-xl font-semibold text-stone-700 mt-10 mb-4 text-left pt-6 border-t border-dashed border-stone-300">Pistas Ling√º√≠sticas de la Objetividad (En Textos Expositivos)</h4>
             <p class="text-left mb-6 text-base text-stone-700">Para parecer objetivos, estos textos suelen usar:</p>
              <p class="text-left mb-6 text-base text-stone-700">Oraciones <strong>enunciativas</strong> (que afirman o niegan algo) y la funci√≥n <strong>referencial</strong> (informar sobre la realidad).</p>
              <p class="text-left mb-6 text-base text-stone-700">La <strong>tercera persona</strong> (√©l/ella/ellos) y el modo <strong>indicativo</strong> (el que usamos normalmente para decir hechos).</p>
              <p class="text-left mb-6 text-base text-stone-700">Palabras con significado claro y directo (<strong>l√©xico denotativo</strong>), <strong>preciso</strong>, y <strong>tecnicismos</strong> (palabras propias de un tema).</p>
              <p class="text-left mb-6 text-base text-stone-700"><strong>Conectores</strong> para ordenar las ideas (por ejemplo, "en primer lugar", "adem√°s", "por lo tanto") y <strong>datos</strong>, <strong>cifras</strong> o <strong>citas</strong> de expertos para dar credibilidad.</p>

             <h4 class="text-xl font-semibold text-stone-700 mt-10 mb-4 text-left pt-6 border-t border-dashed border-stone-300">Recordatorio: Modalidades y Funciones</h4>
             <p class="text-left mb-6 text-base text-stone-700">No olvides las <strong>Modalidades</strong> (la actitud del que habla: afirmar, preguntar, exclamar, mandar, desear, dudar) y las <strong>Funciones</strong> del lenguaje (la intenci√≥n: informar, expresar sentimientos, influir en el otro, comprobar el canal, hablar de la lengua, crear belleza).</p>
         </section>


        <!-- SECCI√ìN ASISTENTE IA (Sin cambios en HTML, solo JS adaptado para clave API) -->
        <section id="gemini-assistant" class="bg-stone-50 border border-stone-200 p-6 rounded-lg shadow-md mb-12 scroll-mt-24">
             <h2 class="text-3xl font-bold text-amber-900 mb-6 border-b-2 pb-3 border-amber-200 text-center">‚ú® Asistente de Estudio IA</h2>
             <div id="api-key-section" class="mb-8 p-4 border border-amber-300 rounded-lg bg-amber-50">
                 {... Contenido secci√≥n API Key ...}
             </div>
             <div id="api-key-message" class="p-4 rounded-md text-sm mb-6 hidden api-key-message">
                 ‚ö†Ô∏è Por favor, introduce y guarda tu Clave API de Google AI Studio...
             </div>
            <p class="mb-6 text-stone-600 text-left">Usa la inteligencia artificial para saber m√°s sobre el Neoclasicismo y el Romanticismo.</p>
             {... Resto del contenido HTML del asistente IA ...}
        </section>

        <!-- SECCI√ìN PODCAST (Sin cambios en HTML, solo JS adaptado para clave API) -->
        <section id="podcast-generator-section" class="bg-stone-50 border border-stone-200 p-6 rounded-lg shadow-md mb-12 scroll-mt-24">
             <h2 class="text-3xl font-bold text-amber-900 mb-6 border-b-2 pb-3 border-amber-200 text-center">üéß Generador de Podcast Completo</h2>
             <div id="api-key-message-podcast" class="p-4 rounded-md text-sm mb-6 hidden api-key-message">
                 ‚ö†Ô∏è Por favor, introduce y guarda tu Clave API...
             </div>
            <p class="mb-6 text-stone-600 text-left">Genera y descarga un archivo de audio WAV con toda la gu√≠a de estudio...</p>
             {... Resto del contenido HTML del podcast ...}
        </section>

    </div>

    <!-- Script para Gemini API (MODIFICADO para pedir API Key) -->
    <script>
        // --- Guion del Podcast ---
        function getPodcastScript() {
            const sections = [
                { id: 'neoclasicismo', title: 'Parte 1: Neoclasicismo' },
                { id: 'prosa-neo', title: 'Parte 2: Prosa Neocl√°sica' },
                { id: 'poesia-teatro-neo', title: 'Parte 3: Poes√≠a y Teatro Neocl√°sico' },
                { id: 'romanticismo', title: 'Parte 4: Romanticismo - Contexto y Caracter√≠sticas' },
                { id: 'poesia-rom', title: 'Parte 5: Poes√≠a Rom√°ntica' },
                { id: 'prosa-teatro-rom', title: 'Parte 6: Prosa y Teatro Rom√°ntico' },
                { id: 'textos', title: 'Parte 7: An√°lisis Textual' }
            ];
            const chunks = {};
            sections.forEach(section => {
                const el = document.getElementById(section.id);
                if (el) {
                    let text = el.innerText || el.textContent || "";
                    text = text.replace(/\[Imagen de.*?\]/g, '');
                    text = text.replace(/(\r\n|\n|\r)/gm, " ").replace(/\s\s+/g, ' ').trim();
                    // Simplificaci√≥n adicional para TTS si es necesario
                    text = text.replace(/‚Äî/g, '-'); // Guiones largos a cortos
                    chunks[section.title] = `${section.title}. ${text}`;
                } else {
                    chunks[section.title] = `${section.title}. Contenido no encontrado.`;
                }
            });
            return chunks;
        }
        let podcastChunks = {};

        // --- DOM Elements ---
        const btnExplain = document.getElementById('btn-explain');
        const btnQuiz = document.getElementById('btn-quiz');
        const btnAnalysis = document.getElementById('btn-analysis');
        const btnTts = document.getElementById('btn-tts');
        const btnVisualize = document.getElementById('btn-visualize');
        const btnExplainImage = document.getElementById('btn-explain-image');
        const fileUpload = document.getElementById('file-upload');
        const btnAnalogy = document.getElementById('btn-analogy');
        const btnCompare = document.getElementById('btn-compare');
        const btnGenerateFullPodcast = document.getElementById('btn-generate-full-podcast');
        const podcastControls = document.getElementById('podcast-controls');
        const fullPodcastPlayer = document.getElementById('full-podcast-player');
        const downloadPodcastLink = document.getElementById('download-podcast-link');
        const podcastStatus = document.getElementById('podcast-status');
        const promptText = document.getElementById('gemini-prompt');
        const promptConcept1 = document.getElementById('prompt-concept-1');
        const promptConcept2 = document.getElementById('prompt-concept-2');
        const loadingEl = document.getElementById('gemini-loading');
        const resultsEl = document.getElementById('gemini-results');
        const audioPlayer = document.getElementById('audio-player');
        const imagePreviewContainer = document.getElementById('image-preview-container');
        const imageResultContainer = document.getElementById('image-result-container');
        const apiKeyInput = document.getElementById('api-key-input');
        const saveApiKeyBtn = document.getElementById('save-api-key-btn');
        const apiKeyStatus = document.getElementById('api-key-status');
        const apiKeyMessages = document.querySelectorAll('.api-key-message');
        const aiButtons = document.querySelectorAll('.ai-button');

        // --- API Config (Variables actualizables) ---
        let API_KEY = "";
        let API_URL_GENERATE = "";
        let API_URL_TTS = "";
        let API_URL_IMAGEN = "";

        let uploadedImageBase64 = null;
        let uploadedMimeType = null;
        let chatHistory = [];

        // --- Funciones API Key y URLs ---
        function updateApiUrls() {
            API_URL_GENERATE = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${API_KEY}`;
            API_URL_TTS = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-tts:generateContent?key=${API_KEY}`;
            API_URL_IMAGEN = `https://generativelanguage.googleapis.com/v1beta/models/imagen-3.0-generate-002:predict?key=${API_KEY}`;
        }

        function checkApiKey() {
            const keyPresent = !!API_KEY;
            apiKeyMessages.forEach(msg => msg.classList.toggle('hidden', keyPresent));
            // Opcional: Deshabilitar/Habilitar botones
            // aiButtons.forEach(btn => btn.disabled = !keyPresent);
            return keyPresent;
        }

        if (saveApiKeyBtn && apiKeyInput && apiKeyStatus) {
            saveApiKeyBtn.addEventListener('click', () => {
                const key = apiKeyInput.value.trim();
                if (key) {
                    API_KEY = key;
                    updateApiUrls();
                    apiKeyStatus.classList.remove('hidden');
                    apiKeyInput.disabled = true;
                    saveApiKeyBtn.disabled = true;
                    saveApiKeyBtn.textContent = "Clave Guardada";
                    checkApiKey();
                }
            });
        }

        // --- UI Functions ---
        function showLoading(message = "Procesando...") {
             if (loadingEl) {
                 loadingEl.querySelector('p').textContent = message;
                 loadingEl.classList.remove('hidden');
             }
             if (resultsEl) resultsEl.innerHTML = '';
             if (resultsEl) resultsEl.classList.add('hidden');
             if (audioPlayer) { audioPlayer.classList.add('hidden'); audioPlayer.src = ''; }
             if (imageResultContainer) { imageResultContainer.innerHTML = ''; imageResultContainer.classList.add('hidden'); }
             if (podcastControls) podcastControls.classList.add('hidden');
             if (fullPodcastPlayer) fullPodcastPlayer.src = '';
             if (downloadPodcastLink) downloadPodcastLink.href = '#';
             if (podcastStatus) podcastStatus.textContent = '';
         }
        function hideLoading() { if (loadingEl) loadingEl.classList.add('hidden'); }

        // --- Core Functions (Pcm/Wav/Fetch) ---
         function base64ToArrayBuffer(b64) { try { const bS = window.atob(b64); const l = bS.length; const b = new Uint8Array(l); for (let i = 0; i < l; i++) { b[i] = bS.charCodeAt(i); } return b.buffer; } catch (e) { console.error("Error Base64:", e); return new ArrayBuffer(0); } }
         function writeString(v, o, s) { for (let i = 0; i < s.length; i++) { v.setUint8(o + i, s.charCodeAt(i)); } }
         function pcmToWav(pcmData, sR) { const nC = 1; const bPS = 16; const bR = sR * nC * bPS / 8; const bA = nC * bPS / 8; let dS; let pB; if (pcmData instanceof Int16Array) { pB = pcmData.buffer; dS = pcmData.byteLength; } else if (pcmData instanceof ArrayBuffer) { pB = pcmData; dS = pcmData.byteLength; } else { console.error("Bad PCM"); return null; } if (dS === 0) { console.error("Empty PCM"); return null; } const bf = new ArrayBuffer(44 + dS); const v = new DataView(bf); writeString(v, 0, 'RIFF'); v.setUint32(4, 36 + dS, true); writeString(v, 8, 'WAVE'); writeString(v, 12, 'fmt '); v.setUint32(16, 16, true); v.setUint16(20, 1, true); v.setUint16(22, nC, true); v.setUint32(24, sR, true); v.setUint32(28, bR, true); v.setUint16(32, bA, true); v.setUint16(34, bPS, true); writeString(v, 36, 'data'); v.setUint32(40, dS, true); try { const pV = new Int16Array(pB); const dV = new Int16Array(bf, 44); dV.set(pV); return new Blob([v], { type: 'audio/wav' }); } catch (e) { console.error("Error creating WAV DataView:", e); return null; } }
         async function fetchWithBackoff(url, options, retries = 5, delay = 1000) { try { const r = await fetch(url, options); if (!r.ok) { let eB; try { eB = await r.json(); } catch (e) { eB = await r.text(); } console.error(`HTTP err ${r.status}`, eB); const errorMessage = `Error ${r.status}: ${typeof eB === 'string' ? eB : JSON.stringify(eB)}`; if ((r.status === 429 || r.status >= 500) && retries > 0) { await new Promise(ok => setTimeout(ok, delay)); return fetchWithBackoff(url, options, retries - 1, delay * 2); } throw new Error(errorMessage); } return r.json(); } catch (e) { console.error("Fetch/JSON err:", e); if (retries > 0) { await new Promise(ok => setTimeout(ok, delay)); return fetchWithBackoff(url, options, retries - 1, delay * 2); } else { console.error("Max retries."); throw e; } } }


        // --- Funciones FollowUp ---
        function addFollowUpUI(c){ /* ... (Sin cambios) ... */ }
        async function handleFollowUp(){
             if (!checkApiKey()) return;
             const fI=document.getElementById('f-i'); if(!fI) return;
             const uP=fI.value; if(!uP.trim()) return;
             const fB=document.getElementById('b-f'); if(!fB) return;
             fI.disabled=true; fB.disabled=true; fB.textContent="Pensando...";
             const uMD=document.createElement('div'); uMD.className='mt-4 p-3 bg-stone-200 rounded text-left'; uMD.innerHTML=`<strong>T√∫:</strong><pre class="bg-stone-200 p-2 rounded whitespace-pre-wrap font-mono">${uP}</pre>`;
             if(resultsEl) resultsEl.appendChild(uMD);
             chatHistory.push({role:"user",parts:[{text:uP}]});
             const cFUI=resultsEl ? resultsEl.querySelector('.f') : null; if(cFUI)cFUI.remove();
             const sE=chatHistory.find(e=>e.role==='system'); const sPT=sE?sE.parts[0].text:"Eres un tutor √∫til.";
             const pL={contents:chatHistory.filter(m=>m.role!=='system'),systemInstruction:{parts:[{text:sPT}]}};
             const op={method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(pL)};
             try{
                 const rs=await fetchWithBackoff(API_URL_GENERATE,op); const t=rs.candidates?.[0]?.content?.parts?.[0]?.text;
                 chatHistory.push({role:"model",parts:[{text:t||"(Sin resp.)"}]});
                 const mMD=document.createElement('div'); mMD.className='mt-4 p-3 bg-blue-100 rounded text-left gemini-answer'; mMD.innerHTML=`<strong>Tutor:</strong><pre class="bg-blue-100 p-2 rounded whitespace-pre-wrap">${t||"(Sin resp.)"}</pre>`;
                 if(resultsEl) resultsEl.appendChild(mMD);
             } catch(e){
                 const eMD=document.createElement('div'); eMD.className='mt-4 p-3 bg-red-100 rounded text-left'; eMD.innerHTML=`<strong>Error:</strong><pre class="bg-red-100 p-2 rounded whitespace-pre-wrap">${e.message}</pre>`;
                 if(resultsEl) resultsEl.appendChild(eMD);
             } finally {
                 if(resultsEl) addFollowUpUI(resultsEl);
                 if(resultsEl) resultsEl.classList.remove('hidden');
                 if(resultsEl) resultsEl.scrollTop=resultsEl.scrollHeight;
             }
         }

        // --- Manejador de Podcast Completo ---
        async function getSingleAudioChunk(text, voiceName = "Vindemiatrix") { /* ... (Sin cambios internos) ... */ }
        if (btnGenerateFullPodcast) {
            btnGenerateFullPodcast.addEventListener('click', async () => {
                if (!checkApiKey()) return;
                const button = btnGenerateFullPodcast; const originalText = button.textContent; button.disabled = true;
                if(podcastStatus) podcastStatus.textContent = "Iniciando generaci√≥n...";
                if(podcastControls) podcastControls.classList.add('hidden');
                // ... resto de la l√≥gica del podcast ...
                 try {
                     // ... bucle for para generar chunks ...
                     if (Object.keys(podcastChunks).length === 0) { podcastChunks = getPodcastScript(); } // Asegurar script
                     const chunkEntries = Object.entries(podcastChunks);
                     let allPcmBuffers = []; let sampleRate = 0; let totalLength = 0;

                     for (let i = 0; i < chunkEntries.length; i++) {
                         // ... (obtener chunk y a√±adir a allPcmBuffers) ...
                         const [title, text] = chunkEntries[i];
                         if(podcastStatus) podcastStatus.textContent = `Generando ${i + 1}/${chunkEntries.length}: ${title}...`;
                         const chunk = await getSingleAudioChunk(`Voz profesor, lee claro: ${text}`, voiceName);
                         if (sampleRate === 0 && chunk.pcmBuffer.byteLength > 0) { sampleRate = chunk.sampleRate; }
                         else if (chunk.sampleRate !== sampleRate && chunk.pcmBuffer.byteLength > 0) { throw new Error("Inconsistent sample rate."); }
                         if (chunk.pcmBuffer.byteLength > 0) { allPcmBuffers.push(chunk.pcmBuffer); totalLength += chunk.pcmBuffer.byteLength; }
                         else { console.warn(`Skipping empty chunk: ${title}`); }
                     }
                     if (totalLength === 0 || sampleRate === 0) throw new Error("No valid audio generated.");

                     if(podcastStatus) podcastStatus.textContent = "Concatenando y empaquetando...";
                     // ... (concatenar buffers y crear WAV) ...
                      const finalPcmBuffer = new ArrayBuffer(totalLength);
                      const finalPcmView = new Uint8Array(finalPcmBuffer);
                      let offset = 0;
                      for (const buffer of allPcmBuffers) { finalPcmView.set(new Uint8Array(buffer), offset); offset += buffer.byteLength; }
                      const finalInt16Array = new Int16Array(finalPcmBuffer);
                      const finalWavBlob = pcmToWav(finalInt16Array, sampleRate);
                      if (!finalWavBlob) throw new Error("Failed to create WAV.");

                     // ... (mostrar controles y enlace descarga) ...
                     const audioUrl = URL.createObjectURL(finalWavBlob);
                     if(fullPodcastPlayer) fullPodcastPlayer.src = audioUrl;
                     if(downloadPodcastLink) downloadPodcastLink.href = audioUrl;
                     if(downloadPodcastLink) downloadPodcastLink.download = "literatura_podcast_completo.wav";
                     if(podcastControls) podcastControls.classList.remove('hidden');
                     if(podcastStatus) podcastStatus.textContent = '';

                 } catch (error) {
                    if(podcastStatus) podcastStatus.textContent = `Error: ${error.message}`;
                    console.error("PODCAST ERROR:", error);
                 } finally {
                    button.textContent = originalText; button.disabled = false;
                 }
            });
        }


        // --- Manejadores de Eventos (Asistente IA) ---
        async function startTextGeneration(systemPrompt, userPrompt, outputContainer, isFollowUp=false) {
             if (!isFollowUp) {
                 showLoading();
                 if (!(systemPrompt.includes("Analizas la imagen"))) chatHistory = [];
             }
             let currentCallHistory = [];
             if (chatHistory.length === 0 || !isFollowUp) {
                 currentCallHistory = [{ role: "user", parts: [{ text: userPrompt }] }];
                 chatHistory = [{ role: "system", parts: [{ text: systemPrompt }] }, ...currentCallHistory];
             } else {
                 chatHistory.push({ role: "user", parts: [{ text: userPrompt }] });
                 currentCallHistory = chatHistory;
             }
             const payload = { contents: currentCallHistory.filter(m => m.role !== 'system'), systemInstruction: { parts: [{ text: systemPrompt }] }, };
             const options = { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) };
             try {
                 const result = await fetchWithBackoff(API_URL_GENERATE, options);
                 const text = result.candidates?.[0]?.content?.parts?.[0]?.text;
                 const modelResponse = { role: "model", parts: [{ text: text || "(No se gener√≥ respuesta)" }] };
                 if (!isFollowUp || chatHistory[chatHistory.length - 1]?.role !== 'model') { chatHistory.push(modelResponse); }
                 return text || "(No se gener√≥ respuesta)";
             } catch (error) { console.error("Error in startTextGeneration:", error); return `Error: ${error.message}`; }
             finally { if (!isFollowUp) { hideLoading(); if(outputContainer) outputContainer.classList.remove('hidden'); } }
         }

        // --- Event Listeners para botones IA (con checkApiKey) ---
        if (btnExplain) btnExplain.addEventListener('click', async () => { if (!checkApiKey()) return; const userPrompt = promptText.value; if (!userPrompt.trim()) return; const systemPrompt = "..."; const fullUserPrompt = `... "${userPrompt}"`; const text = await startTextGeneration(systemPrompt, fullUserPrompt, resultsEl); if(resultsEl) resultsEl.innerHTML = `<div class="gemini-answer"><h4>Explicaci√≥n:</h4><pre>${text}</pre></div>`; addFollowUpUI(resultsEl); });
        if (btnAnalogy) btnAnalogy.addEventListener('click', async () => { if (!checkApiKey()) return; const userPrompt = promptText.value; if (!userPrompt.trim()) return; const systemPrompt = "..."; const fullUserPrompt = `... "${userPrompt}"`; const text = await startTextGeneration(systemPrompt, fullUserPrompt, resultsEl); if(resultsEl) resultsEl.innerHTML = `<div class="gemini-answer"><h4>Analog√≠a:</h4><pre>${text}</pre></div>`; addFollowUpUI(resultsEl); });
        if (btnCompare) btnCompare.addEventListener('click', async () => { if (!checkApiKey()) return; const c1 = promptConcept1.value; const c2 = promptConcept2.value; if (!c1.trim() || !c2.trim()) return; chatHistory = []; showLoading("Comparando..."); const systemPrompt = `... '${c1}', '${c2}'.`; const fullUserPrompt = `Compara "${c1}" con "${c2}".`; const payload = { contents: [{ parts: [{ text: fullUserPrompt }] }], systemInstruction: { parts: [{ text: systemPrompt }] }, }; const options = { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) }; try { const result = await fetchWithBackoff(API_URL_GENERATE, options); const htmlTable = result.candidates?.[0]?.content?.parts?.[0]?.text; if (htmlTable && htmlTable.trim().startsWith('<table') && htmlTable.trim().endsWith('</table>')) { if(resultsEl) resultsEl.innerHTML = `<h4>Comparativa: ${c1} vs. ${c2}</h4>${htmlTable}`; } else { console.warn("Invalid HTML table:", htmlTable); if(resultsEl) resultsEl.innerHTML = `<h4>Comparativa...</h4><p>Error...</p><pre>${htmlTable || '(Vac√≠a)'}</pre>`; } } catch (error) { if(resultsEl) resultsEl.innerHTML = `<h4>Error:</h4><pre>${error.message}</pre>`; } finally { hideLoading(); if(resultsEl) resultsEl.classList.remove('hidden'); } });
        if (btnQuiz) btnQuiz.addEventListener('click', async () => { if (!checkApiKey()) return; const userPrompt = promptText.value; if (!userPrompt.trim()) return; const systemPrompt = "... Formato *exacto*: 'PREGUNTA #: ... RESPUESTA: [Letra]\n---'."; const fullUserPrompt = `... sobre: "${userPrompt}"`; const resultText = await startTextGeneration(systemPrompt, fullUserPrompt, resultsEl); const questions = resultText.split('---'); let quizHtml = '<h4>Preguntas Tipo Test:</h4>'; questions.forEach((q, index) => { const parts = q.trim().split(/\nRESPUESTA:/); const questionBlock = parts[0]; const answer = parts[1] ? parts[1].trim() : "N/A"; if(questionBlock) { quizHtml += `<div class="mt-4 p-4 ... gemini-answer"><pre ...>${questionBlock}</pre><div id="answer-${index}" class="hidden ..."><strong>Respuesta:</strong> ${answer}</div><button onclick="toggleAnswer('answer-${index}')" ...>Mostrar/Ocultar Respuesta</button></div>`; } }); if(resultsEl) resultsEl.innerHTML = quizHtml; addFollowUpUI(resultsEl); });
        if (btnAnalysis) btnAnalysis.addEventListener('click', async () => { if (!checkApiKey()) return; const userPrompt = promptText.value; if (!userPrompt.trim()) return; const systemPrompt = "... Formato: 'AN√ÅLISIS: ...\n---\nCONCLUSI√ìN: ...'"; const fullUserPrompt = `... de: "${userPrompt}"`; const resultText = await startTextGeneration(systemPrompt, fullUserPrompt, resultsEl); const parts = resultText.split('---'); const analysisBlock = parts[0] ? parts[0].replace('AN√ÅLISIS:', '').trim() : "No generado."; const conclusionBlock = parts[1] ? parts[1].replace('CONCLUSI√ìN:', '').trim() : ""; let analysisHtml = `<div class="gemini-answer"><h4>An√°lisis Literario:</h4><pre>${analysisBlock}</pre>${conclusionBlock ? `<div class="mt-3 pt-3 ..."><pre><strong>CONCLUSI√ìN:</strong>\n${conclusionBlock}</pre></div>` : ''}</div>`; if(resultsEl) resultsEl.innerHTML = analysisHtml; addFollowUpUI(resultsEl); });
        if (btnTts) btnTts.addEventListener('click', async () => { if (!checkApiKey()) return; const userPrompt = promptText.value; if (!userPrompt.trim()) return; showLoading("Generando audio..."); chatHistory = []; const payload = { contents: [{ parts: [{ text: `Voz profesor, lee espa√±ol: ${userPrompt}` }] }], generationConfig: { responseModalities: ["AUDIO"], speechConfig: { voiceConfig: { prebuiltVoiceConfig: { voiceName: "Vindemiatrix" } } } }, model: "gemini-2.5-flash-preview-tts" }; const options = { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) }; try { const result = await fetchWithBackoff(API_URL_TTS, options); const part = result?.candidates?.[0]?.content?.parts?.[0]; const audioData = part?.inlineData?.data; const mimeType = part?.inlineData?.mimeType; if (audioData && mimeType?.startsWith("audio/")) { const sampleRateMatch = mimeType.match(/rate=(\d+)/); const sampleRate = sampleRateMatch ? parseInt(sampleRateMatch[1], 10) : 24000; const pcmBuffer = base64ToArrayBuffer(audioData); if (pcmBuffer.byteLength === 0) throw new Error("PCM vac√≠o."); const pcm16 = new Int16Array(pcmBuffer); const wavBlob = pcmToWav(pcm16, sampleRate); if (!wavBlob) throw new Error("Fallo WAV."); const audioUrl = URL.createObjectURL(wavBlob); if(audioPlayer) { audioPlayer.src = audioUrl; audioPlayer.classList.remove('hidden'); audioPlayer.play(); } } else { throw new Error(`Respuesta TTS inv√°lida`); } } catch (error) { console.error("TTS Error:", error); if(resultsEl) { resultsEl.innerHTML = `<h4>Error Audio:</h4><pre>${error.message}</pre>`; resultsEl.classList.remove('hidden'); } } finally { hideLoading(); } });
        if (btnVisualize) btnVisualize.addEventListener('click', async () => { if (!checkApiKey()) return; const userPrompt = promptText.value; if (!userPrompt.trim()) return; showLoading("Generando imagen..."); chatHistory = []; const fullPrompt = `... representando: "${userPrompt}" ...`; const payload = { instances: [{ prompt: fullPrompt }], parameters: { "sampleCount": 1 } }; const options = { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) }; try { const result = await fetchWithBackoff(API_URL_IMAGEN, options); const base64Data = result.predictions?.[0]?.bytesBase64Encoded; if (base64Data) { const imageUrl = `data:image/png;base64,${base64Data}`; if(imageResultContainer) { imageResultContainer.innerHTML = `<h4>Visualizaci√≥n:</h4><img src="${imageUrl}" alt="..." class="...">`; imageResultContainer.classList.remove('hidden'); } } else { throw new Error(`Respuesta Imagen inv√°lida`); } } catch (error) { console.error("Visualize Error:", error); if(resultsEl) { resultsEl.innerHTML = `<h4>Error Imagen:</h4><pre>${error.message}</pre>`; resultsEl.classList.remove('hidden'); } } finally { hideLoading(); } });
        if (fileUpload) fileUpload.addEventListener('change', () => { const file = fileUpload.files[0]; if (!file) return; const reader = new FileReader(); reader.onloadend = () => { const dataUrl = reader.result; uploadedMimeType = dataUrl.substring(dataUrl.indexOf(':')+1, dataUrl.indexOf(';')); uploadedImageBase64 = dataUrl.substring(dataUrl.indexOf(',')+1); if(imagePreviewContainer) { imagePreviewContainer.innerHTML = `<h4>Vista Previa:</h4><img src="${dataUrl}" alt="..." class="...">`; imagePreviewContainer.classList.remove('hidden'); } /* Reset other outputs */ if(resultsEl) resultsEl.innerHTML = ''; if(resultsEl) resultsEl.classList.add('hidden'); if(imageResultContainer) imageResultContainer.innerHTML = ''; if(imageResultContainer) imageResultContainer.classList.add('hidden'); if(audioPlayer) { audioPlayer.classList.add('hidden'); audioPlayer.src = ''; } if(podcastControls) podcastControls.classList.add('hidden'); }; reader.readAsDataURL(file); });
        if (btnExplainImage) btnExplainImage.addEventListener('click', async () => { if (!checkApiKey()) return; if (!uploadedImageBase64) return; const userPrompt = promptText.value.trim() || "..."; const systemPrompt = "..."; const imagePrompt = { role: "user", parts: [ { text: userPrompt }, { inlineData: { mimeType: uploadedMimeType || "image/jpeg", data: uploadedImageBase64 } } ] }; showLoading("Analizando imagen..."); chatHistory = [ { role: "system", parts: [{ text: systemPrompt }] }, imagePrompt ]; const payload = { contents: chatHistory.filter(m => m.role === 'user'), systemInstruction: { parts: [{ text: systemPrompt }] }, }; const options = { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) }; try { const result = await fetchWithBackoff(API_URL_GENERATE, options); const text = result.candidates?.[0]?.content?.parts?.[0]?.text; if(text) chatHistory.push({ role: "model", parts: [{ text }] }); if(resultsEl) { resultsEl.innerHTML = `<div class="gemini-answer"><h4>An√°lisis de Imagen:</h4><pre>${text || "No se pudo."}</pre></div>`; resultsEl.classList.remove('hidden'); } addFollowUpUI(resultsEl); } catch (error) { if(resultsEl) { resultsEl.innerHTML = `<h4>Error:</h4><pre>${error.message}</pre>`; resultsEl.classList.remove('hidden'); } } finally { hideLoading(); if(imagePreviewContainer) imagePreviewContainer.classList.remove('hidden'); } });

        // --- Funci√≥n global toggleAnswer ---
        window.toggleAnswer = function(id) { const answerEl = document.getElementById(id); if (answerEl) answerEl.classList.toggle('hidden'); }
        
        // --- Carga inicial ---
        window.addEventListener('DOMContentLoaded', () => {
            podcastChunks = getPodcastScript();
            updateApiUrls(); // Actualiza con API_KEY vac√≠a
            checkApiKey(); // Muestra mensaje si es necesario
        });

    </script>
</body>
</html>
