<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Biblia de Redes (T4-T8) | Nivel Experto</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;900&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #0f172a; color: #e2e8f0; }
        
        /* Scrollbar */
        ::-webkit-scrollbar { width: 10px; }
        ::-webkit-scrollbar-track { background: #1e293b; }
        ::-webkit-scrollbar-thumb { background: #3b82f6; border-radius: 5px; }
        ::-webkit-scrollbar-thumb:hover { background: #2563eb; }

        /* Estilos de Tablas (CENTRADAS) */
        .table-wrapper { overflow-x: auto; margin: 2rem 0; border-radius: 0.75rem; border: 1px solid #334155; }
        table { width: 100%; border-collapse: collapse; text-align: center; } /* Todo centrado */
        th { background: #1e293b; color: #60a5fa; padding: 1rem; font-weight: 800; text-transform: uppercase; letter-spacing: 0.05em; border-bottom: 2px solid #3b82f6; text-align: center; }
        td { padding: 1rem; border-bottom: 1px solid #334155; color: #cbd5e1; vertical-align: middle; text-align: center; }
        tr:last-child td { border-bottom: none; }
        tr:nth-child(even) { background-color: rgba(30, 41, 59, 0.5); }
        tr:hover { background-color: rgba(59, 130, 246, 0.1); }

        /* Layout */
        .sidebar { position: fixed; top: 0; left: 0; height: 100vh; width: 280px; background: #0f172a; border-right: 1px solid #1e293b; overflow-y: auto; z-index: 50; }
        .main-content { margin-left: 280px; padding: 3rem; max-w: 1400px; }
        
        /* Tarjetas de Teor√≠a */
        .theory-card { background: #1e293b; border: 1px solid #334155; border-radius: 1rem; margin-bottom: 3rem; box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.3); }
        .theory-header { background: linear-gradient(to right, #1d4ed8, #1e40af); padding: 1.5rem; border-bottom: 1px solid #334155; }
        .theory-body { padding: 2rem; }

        /* Cajas de √ânfasis */
        .detail-box { background: rgba(16, 185, 129, 0.1); border-left: 4px solid #10b981; padding: 1.5rem; margin: 1.5rem 0; border-radius: 0 0.5rem 0.5rem 0; }
        .alert-box { background: rgba(239, 68, 68, 0.1); border-left: 4px solid #ef4444; padding: 1.5rem; margin: 1.5rem 0; border-radius: 0 0.5rem 0.5rem 0; }
        .cmd-box { background: #020617; font-family: 'Courier New', monospace; padding: 1rem; border-radius: 0.5rem; border: 1px solid #334155; color: #22d3ee; margin: 1rem 0; white-space: pre-wrap; }

        /* Simulador */
        .option-btn { width: 100%; text-align: left; padding: 1.25rem; margin-bottom: 0.75rem; border: 2px solid #334155; border-radius: 0.75rem; background: #1e293b; color: #e2e8f0; transition: all 0.2s; font-weight: 500; }
        .option-btn:hover:not(:disabled) { border-color: #3b82f6; background: #334155; }
        .option-btn.correct { border-color: #10b981; background: rgba(16, 185, 129, 0.2); color: #34d399; }
        .option-btn.incorrect { border-color: #ef4444; background: rgba(239, 68, 68, 0.2); color: #fca5a5; }
    </style>
</head>
<body>

    <!-- Men√∫ Lateral -->
    <aside class="sidebar hidden md:block">
        <div class="p-6">
            <h1 class="text-3xl font-black text-white mb-1 tracking-tighter">NET<span class="text-blue-500">MASTER</span></h1>
            <p class="text-xs text-blue-400 font-bold tracking-widest uppercase mb-10">Edici√≥n 200% Teor√≠a</p>
            
            <nav class="space-y-2">
                <a href="#t4" class="flex items-center gap-3 px-4 py-3 text-sm font-bold text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition"><i class="fa-solid fa-sitemap w-5 text-center"></i> T4: Jer√°rquicas</a>
                <a href="#t5" class="flex items-center gap-3 px-4 py-3 text-sm font-bold text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition"><i class="fa-solid fa-network-wired w-5 text-center"></i> T5: STP Avanzado</a>
                <a href="#t6" class="flex items-center gap-3 px-4 py-3 text-sm font-bold text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition"><i class="fa-solid fa-tags w-5 text-center"></i> T6: VLANs & 802.1Q</a>
                <a href="#t7" class="flex items-center gap-3 px-4 py-3 text-sm font-bold text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition"><i class="fa-solid fa-server w-5 text-center"></i> T7: VTP Total</a>
                <a href="#t8" class="flex items-center gap-3 px-4 py-3 text-sm font-bold text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition"><i class="fa-solid fa-route w-5 text-center"></i> T8: Inter-VLAN</a>
            </nav>

            <div class="mt-12 p-4 bg-gradient-to-br from-blue-900 to-slate-900 rounded-xl border border-blue-800">
                <h4 class="text-white font-bold mb-2"><i class="fa-solid fa-graduation-cap mr-2"></i>Modo Examen</h4>
                <p class="text-xs text-blue-200 mb-4">Preguntas ilimitadas y aleatorias.</p>
                <a href="#simulator" class="block text-center bg-blue-600 hover:bg-blue-500 text-white font-bold py-2 px-4 rounded-lg transition text-sm shadow-lg">
                    Iniciar Test
                </a>
            </div>
        </div>
    </aside>

    <!-- Contenido -->
    <main class="main-content md:ml-64">
        
        <!-- TEMA 4 -->
        <section id="t4" class="theory-card">
            <div class="theory-header">
                <h2 class="text-2xl font-bold text-white"><span class="text-blue-300 mr-3">TEMA 4</span> Redes Jer√°rquicas</h2>
            </div>
            <div class="theory-body">
                <h3 class="text-xl font-bold text-blue-400 mb-4">1. El Modelo de 3 Capas (Detalle Exhaustivo)</h3>
                <p class="mb-4">Dise√±o modular para escalabilidad, redundancia, rendimiento y facilidad de mantenimiento. Supera a las redes planas.</p>
                
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th width="20%">Capa</th>
                                <th width="30%">Funci√≥n Principal</th>
                                <th width="50%">Caracter√≠sticas T√©cnicas (Clave Examen)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="font-bold text-green-400">ACCESO<br>(Access Layer)</td>
                                <td>Conexi√≥n de usuarios (Edge)</td>
                                <td>
                                    <ul class="text-left list-disc pl-6 space-y-1 text-sm">
                                        <li><strong>Port Security</strong> y control de acceso.</li>
                                        <li>VLANs y marcado QoS (Clasificaci√≥n).</li>
                                        <li><strong>PoE</strong> (Power over Ethernet) para Tel√©fonos IP y APs.</li>
                                        <li>ARP Inspection.</li>
                                        <li>Switches de bajo coste/alta densidad.</li>
                                        <li><strong>NO</strong> suele tener redundancia al host (1 cable).</li>
                                    </ul>
                                </td>
                            </tr>
                            <tr>
                                <td class="font-bold text-blue-400">DISTRIBUCI√ìN<br>(Distribution Layer)</td>
                                <td>Agregaci√≥n y Pol√≠ticas</td>
                                <td>
                                    <ul class="text-left list-disc pl-6 space-y-1 text-sm">
                                        <li><strong>Punto de demarcaci√≥n L2/L3.</strong></li>
                                        <li>Enrutamiento Inter-VLAN.</li>
                                        <li>Aplicaci√≥n de pol√≠ticas de seguridad (ACLs).</li>
                                        <li>Redundancia hacia el N√∫cleo y Acceso.</li>
                                        <li>Sumarizaci√≥n de rutas.</li>
                                    </ul>
                                </td>
                            </tr>
                            <tr>
                                <td class="font-bold text-red-400">N√öCLEO<br>(Core Layer)</td>
                                <td>Backbone de Alta Velocidad</td>
                                <td>
                                    <ul class="text-left list-disc pl-6 space-y-1 text-sm">
                                        <li><strong>Conmutaci√≥n de paquetes a m√°xima velocidad.</strong></li>
                                        <li>Fiabilidad extrema y redundancia.</li>
                                        <li><strong>PROHIBIDO:</strong> Tareas intensivas en CPU (ACLs, inspecci√≥n de paquetes, enrutamiento complejo). Ralentizan.</li>
                                        <li>Hardware: Fibra √≥ptica (10G/40G/100G).</li>
                                    </ul>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="detail-box">
                    <strong>Excepci√≥n de Dise√±o: N√∫cleo Colapsado (Collapsed Core)</strong>
                    <p class="mt-1 text-sm">En redes peque√±as, se fusionan las capas de <strong>Distribuci√≥n y N√∫cleo</strong> en una sola capa. Reduce costes pero limita la escalabilidad.</p>
                </div>

                <h3 class="text-xl font-bold text-blue-400 mb-4 mt-8">2. Principios de Dise√±o y Hardware</h3>
                <ul class="list-disc pl-5 space-y-2 mb-6">
                    <li><strong>Di√°metro de la Red:</strong> N√∫mero de saltos entre origen y destino. Debe mantenerse bajo y predecible para garantizar baja latencia.</li>
                    <li><strong>Agregado de Ancho de Banda (EtherChannel):</strong> Combinar enlaces f√≠sicos en uno l√≥gico. Vital en uplinks (Acceso->Distribuci√≥n).</li>
                    <li><strong>Redundancia:</strong> Duplicar enlaces y equipos. Obligatorio en Distribuci√≥n y N√∫cleo.</li>
                </ul>

                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr><th>Factor de Forma</th><th>Descripci√≥n</th><th>Uso T√≠pico</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="font-bold">Configuraci√≥n Fija</td>
                                <td>Puertos inamovibles (24/48). Menor coste.</td>
                                <td>Capa de Acceso.</td>
                            </tr>
                            <tr>
                                <td class="font-bold">Modular</td>
                                <td>Chasis con tarjetas de l√≠nea (line cards). M√°xima escalabilidad.</td>
                                <td>Distribuci√≥n y N√∫cleo.</td>
                            </tr>
                            <tr>
                                <td class="font-bold">Apilable (Stackable)</td>
                                <td>Varios switches unidos por cable especial (StackWise). Act√∫an como <strong>UNA unidad l√≥gica</strong> (plano de control √∫nico, m√°s ancho de banda).</td>
                                <td>Acceso (alta densidad).</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- TEMA 5 -->
        <section id="t5" class="theory-card">
            <div class="theory-header">
                <h2 class="text-2xl font-bold text-white"><span class="text-blue-300 mr-3">TEMA 5</span> STP (Spanning Tree Protocol)</h2>
            </div>
            <div class="theory-body">
                <div class="alert-box">
                    <strong class="text-red-400 text-lg"><i class="fa-solid fa-triangle-exclamation"></i> Problemas de la Redundancia L2</strong>
                    <p class="mt-2">Sin STP, los bucles f√≠sicos causan:</p>
                    <ol class="list-decimal pl-5 mt-1 font-bold text-white">
                        <li>Tormentas de Broadcast (Broadcast Storms).</li>
                        <li>Inestabilidad de la tabla de direcciones MAC.</li>
                        <li>Transmisi√≥n de tramas duplicadas.</li>
                    </ol>
                </div>

                <h3 class="text-xl font-bold text-blue-400 mb-4 mt-8">1. Algoritmo STP (IEEE 802.1D) - El detalle importa</h3>
                <p class="mb-4">El objetivo es crear una topolog√≠a l√≥gica de √°rbol (sin bucles) bloqueando puertos.</p>

                <div class="bg-slate-800 p-6 rounded-xl border border-slate-700 mb-6">
                    <h4 class="text-lg font-bold text-white mb-3 border-b border-slate-600 pb-2">PASO 1: Elecci√≥n del Puente Ra√≠z (Root Bridge)</h4>
                    <p class="mb-2">Solo hay <strong>UNO</strong> por VLAN. Gana el switch con el <strong>BID (Bridge ID) m√°s bajo</strong>.</p>
                    <div class="cmd-box text-center">BID = Prioridad (2 bytes) + Direcci√≥n MAC (6 bytes)</div>
                    <ul class="list-disc pl-5 text-sm">
                        <li>Prioridad por defecto: <strong>32768</strong> (+ ID VLAN en PVST+).</li>
                        <li><strong>Criterio de Desempate:</strong> Si las prioridades son iguales, gana la <strong>MAC m√°s baja</strong>.</li>
                    </ul>
                </div>

                <div class="bg-slate-800 p-6 rounded-xl border border-slate-700 mb-6">
                    <h4 class="text-lg font-bold text-white mb-3 border-b border-slate-600 pb-2">PASO 2: Elecci√≥n de Puertos Ra√≠z (Root Ports - RP)</h4>
                    <p class="mb-2">Cada switch NO-Ra√≠z elige <strong>un solo</strong> puerto: el mejor camino hacia el Ra√≠z.</p>
                    <p class="font-bold text-blue-400 mb-1">Criterios de desempate (en orden):</p>
                    <ol class="list-decimal pl-5 text-sm space-y-1">
                        <li>Menor Costo acumulado hacia el Ra√≠z.</li>
                        <li>Menor BID del switch vecino (Sender Bridge ID).</li>
                        <li>Menor Prioridad de Puerto del vecino (Sender Port Priority, default 128).</li>
                        <li>Menor ID de Puerto del vecino (Sender Port ID).</li>
                    </ol>
                </div>

                <h3 class="text-xl font-bold text-blue-400 mb-4">2. Costos de Puerto (IEEE Revisado)</h3>
                <p class="mb-4">¬°OJO! El examen usa los valores revisados (actuales), no los antiguos.</p>
                <div class="table-wrapper">
                    <table>
                        <thead><tr><th>Velocidad de Enlace</th><th>Costo (IEEE Viejo)</th><th>Costo (IEEE Revisado)</th></tr></thead>
                        <tbody>
                            <tr><td>10 Gbps</td><td>1</td><td class="font-black text-green-400 text-lg">2</td></tr>
                            <tr><td>1 Gbps</td><td>4</td><td class="font-black text-green-400 text-lg">4</td></tr>
                            <tr><td>100 Mbps</td><td>10</td><td class="font-black text-green-400 text-lg">19</td></tr>
                            <tr><td>10 Mbps</td><td>100</td><td class="font-black text-green-400 text-lg">100</td></tr>
                        </tbody>
                    </table>
                </div>

                <h3 class="text-xl font-bold text-blue-400 mb-4 mt-8">3. Estados y Temporizadores (802.1D)</h3>
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <div>
                        <h4 class="font-bold text-white mb-2">Estados del Puerto</h4>
                        <ul class="list-disc pl-5 space-y-2 text-sm">
                            <li><strong>Blocking (20s):</strong> Solo recibe BPDU. No env√≠a datos, no aprende MAC. (Espera Max Age).</li>
                            <li><strong>Listening (15s):</strong> Env√≠a/Recibe BPDU. Prepara elecci√≥n. No aprende MAC. (Forward Delay).</li>
                            <li><strong>Learning (15s):</strong> Env√≠a/Recibe BPDU. <strong>Aprende MACs</strong>. No env√≠a datos. (Forward Delay).</li>
                            <li><strong>Forwarding:</strong> Estado operativo. Env√≠a datos y aprende MACs.</li>
                            <li><strong>Disabled:</strong> Apagado administrativamente.</li>
                        </ul>
                    </div>
                    <div>
                        <h4 class="font-bold text-white mb-2">Temporizadores (Timers)</h4>
                        <ul class="list-disc pl-5 space-y-2 text-sm">
                            <li><strong>Hello Time:</strong> 2 segundos. (Frecuencia de BPDUs del Ra√≠z).</li>
                            <li><strong>Max Age:</strong> 20 segundos. (Tiempo de vida de la info del BPDU).</li>
                            <li><strong>Forward Delay:</strong> 15 segundos. (Tiempo en Listening y en Learning).</li>
                            <li class="border-t border-slate-600 pt-2 text-yellow-400 font-bold">Convergencia Total: 50 segundos (20 + 15 + 15).</li>
                        </ul>
                    </div>
                </div>

                <div class="detail-box mt-6">
                    <strong>Mejoras y Variantes:</strong>
                    <ul class="list-disc pl-5 mt-2 text-sm">
                        <li><strong>PortFast (Cisco):</strong> Para puertos de acceso. Salta Listening/Learning y pasa a Forwarding INSTANT√ÅNEAMENTE. Evita problemas DHCP.</li>
                        <li><strong>PVST+ (Cisco):</strong> Per-VLAN Spanning Tree Plus. Una instancia STP por cada VLAN. Permite balanceo de carga (Root de VLAN 10 en Switch A, Root de VLAN 20 en Switch B).</li>
                        <li><strong>RSTP (802.1w):</strong> Est√°ndar r√°pido. Convergencia en sub-segundos. Estados: Discarding, Learning, Forwarding. Roles nuevos: Alternate (backup de RP) y Backup (backup de DP).</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- TEMA 6 -->
        <section id="t6" class="theory-card">
            <div class="theory-header">
                <h2 class="text-2xl font-bold text-white"><span class="text-blue-300 mr-3">TEMA 6</span> VLANs y Trunking</h2>
            </div>
            <div class="theory-body">
                <h3 class="text-xl font-bold text-blue-400 mb-4">1. Tipos de VLAN</h3>
                <div class="table-wrapper">
                    <table>
                        <thead><tr><th>Tipo</th><th>Descripci√≥n y Uso Cr√≠tico</th></tr></thead>
                        <tbody>
                            <tr><td class="font-bold text-blue-300">Datos</td><td>Tr√°fico de usuario normal.</td></tr>
                            <tr><td class="font-bold text-blue-300">Predeterminada</td><td><strong>VLAN 1</strong>. Todos los puertos pertenecen a ella por defecto. Lleva tr√°fico de control (CDP, PAgP, VTP). Insegura.</td></tr>
                            <tr><td class="font-bold text-yellow-300">Nativa</td><td>Exclusiva de Trunks 802.1Q. El tr√°fico va <strong>SIN ETIQUETA (Untagged)</strong>. Por defecto es la 1 (debe cambiarse a 99, etc.). Si no coincide en ambos extremos -> "Native VLAN Mismatch".</td></tr>
                            <tr><td class="font-bold text-blue-300">Gesti√≥n</td><td>VLAN SVI configurada con IP para administrar el switch (SSH/Telnet).</td></tr>
                            <tr><td class="font-bold text-purple-300">Voz</td><td>Para tel√©fonos IP. Requiere QoS, ancho de banda garantizado, prioridad alta. El tel√©fono IP tiene un switch de 3 puertos integrado.</td></tr>
                        </tbody>
                    </table>
                </div>

                <h3 class="text-xl font-bold text-blue-400 mb-4 mt-8">2. Etiquetado 802.1Q (Bit a Bit)</h3>
                <p class="mb-2">Inserta un <strong>Tag de 4 Bytes</strong> en la trama Ethernet original.</p>
                <div class="bg-black p-4 rounded border border-slate-600 font-mono text-sm text-center text-green-400 mb-4">
                    [ MAC Dest | MAC Orig | <span class="text-yellow-400 font-bold bg-slate-800 px-1">TAG (4 Bytes)</span> | Tipo/Longitud | Datos | FCS ]
                </div>
                <div class="bg-slate-800 p-4 rounded border border-slate-600 mb-6">
                    <strong class="text-white">Estructura del TAG (4 Bytes = 32 bits):</strong>
                    <ul class="list-disc pl-5 mt-2 text-sm space-y-2">
                        <li><strong>TPID (Tag Protocol Identifier) - 16 bits:</strong> Valor fijo <code>0x8100</code>. Indica que la trama es 802.1Q.</li>
                        <li><strong>TCI (Tag Control Information) - 16 bits:</strong>
                            <ul class="list-circle pl-5 mt-1 text-slate-400">
                                <li><strong>Prioridad (PRI) - 3 bits:</strong> Usado para CoS (Class of Service) / QoS (802.1p).</li>
                                <li><strong>CFI (Canonical Format Indicator) - 1 bit:</strong> Compatibilidad con Token Ring (0 para Ethernet).</li>
                                <li><strong>VID (VLAN ID) - 12 bits:</strong> El identificador de la VLAN. (2^12 = 4096 VLANs).</li>
                            </ul>
                        </li>
                    </ul>
                </div>

                <h3 class="text-xl font-bold text-blue-400 mb-4">3. Almacenamiento de VLANs</h3>
                <ul class="list-disc pl-5 space-y-2">
                    <li><strong>Rango Normal (1 - 1005):</strong> Se guardan en el archivo <code>vlan.dat</code> en la memoria Flash. Se sincronizan con VTP. (IDs 1002-1005 reservados para Token Ring/FDDI).</li>
                    <li><strong>Rango Extendido (1006 - 4094):</strong> Se guardan en <code>running-config</code> (NVRAM). Requieren VTP en modo Transparente.</li>
                </ul>
            </div>
        </section>

        <!-- TEMA 7 -->
        <section id="t7" class="theory-card">
            <div class="theory-header">
                <h2 class="text-2xl font-bold text-white"><span class="text-blue-300 mr-3">TEMA 7</span> Protocolo VTP</h2>
            </div>
            <div class="theory-body">
                <p class="mb-6">VLAN Trunking Protocol (Propietario de Cisco). Sincroniza la creaci√≥n, borrado y renombrado de VLANs.</p>

                <div class="table-wrapper">
                    <table>
                        <thead><tr><th>Modo</th><th>Crea/Borra VLANs</th><th>Sincroniza BD</th><th>Reenv√≠a VTP</th><th>Ubicaci√≥n Guardado</th></tr></thead>
                        <tbody>
                            <tr><td class="font-bold text-green-400">Servidor</td><td>‚úÖ S√ç</td><td>‚úÖ S√ç</td><td>‚úÖ S√ç</td><td>NVRAM (vlan.dat)</td></tr>
                            <tr><td class="font-bold text-blue-400">Cliente</td><td>‚ùå NO</td><td>‚úÖ S√ç</td><td>‚úÖ S√ç</td><td>RAM (se pierde al reinicio)</td></tr>
                            <tr><td class="font-bold text-slate-400">Transparente</td><td>‚úÖ S√ç (Solo locales)</td><td>‚ùå NO</td><td>‚úÖ S√ç (V2) / NO (V1)</td><td>NVRAM (local)</td></tr>
                        </tbody>
                    </table>
                </div>

                <div class="alert-box">
                    <strong class="text-red-400 text-xl"><i class="fa-solid fa-bomb"></i> PELIGRO: N√∫mero de Revisi√≥n (Revision Number)</strong>
                    <p class="mt-2">Es un contador de 32 bits que aumenta +1 con cada cambio de VLAN. Los switches <strong>SIEMPRE conf√≠an en la revisi√≥n m√°s alta</strong>.</p>
                    <p class="mt-2 font-bold text-white">Escenario de Desastre:</p>
                    <p class="text-sm">Si conectas un switch de laboratorio con Revisi√≥n Alta y BD vac√≠a a la red de producci√≥n -> <strong>BORRAR√Å TODAS LAS VLANs DE LA RED</strong>.</p>
                    <p class="mt-2"><strong>C√≥mo Resetear la Revisi√≥n a 0:</strong></p>
                    <ul class="list-disc pl-5 text-sm">
                        <li>Cambiar el nombre de dominio VTP a uno inexistente y volver al original.</li>
                        <li>Cambiar el modo a Transparente y luego volver a Servidor/Cliente.</li>
                    </ul>
                </div>

                <h3 class="text-xl font-bold text-blue-400 mb-4 mt-8">Mensajes VTP y Pruning</h3>
                <ul class="list-disc pl-5 space-y-2">
                    <li><strong>Resumen (Summary Advertisement):</strong> Enviado cada 5 minutos o tras un cambio. Contiene Nombre Dominio, Revisi√≥n, Timestamp, MD5.</li>
                    <li><strong>Subconjunto (Subset Advertisement):</strong> Enviado tras un cambio. Contiene la lista detallada de VLANs.</li>
                    <li><strong>Petici√≥n (Request Advertisement):</strong> Enviado por un cliente que necesita actualizarse (ej. al arrancar o ver revisi√≥n mayor).</li>
                    <li><strong>VTP Pruning (Poda):</strong> Optimizaci√≥n que evita enviar tr√°fico de broadcast/multicast de una VLAN a trav√©s de enlaces troncales hacia switches que NO tienen puertos en esa VLAN. Ahorra ancho de banda.</li>
                </ul>
            </div>
        </section>

        <!-- TEMA 8 -->
        <section id="t8" class="theory-card">
            <div class="theory-header">
                <h2 class="text-2xl font-bold text-white"><span class="text-blue-300 mr-3">TEMA 8</span> Enrutamiento Inter-VLAN</h2>
            </div>
            <div class="theory-body">
                <p class="mb-6">Las VLANs son dominios de broadcast (L2) aislados. Para comunicar VLAN 10 con VLAN 20, el tr√°fico debe pasar por un dispositivo de Capa 3 (Router o Switch L3).</p>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <!-- ROAS -->
                    <div class="bg-slate-900 p-6 rounded-xl border border-slate-700">
                        <h4 class="text-xl font-bold text-purple-400 mb-3 border-b border-slate-600 pb-2">1. Router-on-a-Stick (ROAS)</h4>
                        <p class="text-sm mb-4 text-slate-300">Router externo conectado al switch por <strong>un enlace troncal</strong>.</p>
                        <ul class="list-disc pl-5 space-y-2 text-sm mb-4">
                            <li>Usa <strong>Subinterfaces</strong> l√≥gicas (ej. <code>Fa0/0.10</code>).</li>
                            <li>La interfaz f√≠sica NO debe tener IP.</li>
                            <li>Cuello de botella f√≠sico (todo el tr√°fico sube y baja por un cable).</li>
                        </ul>
                        <div class="cmd-box">
Router(config)# int g0/0.10
Router(config-subif)# encapsulation dot1q 10
Router(config-subif)# ip address 192.168.10.1 255.255.255.0
Router(config-subif)# int g0/0.20
Router(config-subif)# encapsulation dot1q 20
Router(config-subif)# ip address 192.168.20.1 255.255.255.0</div>
                    </div>

                    <!-- SVI -->
                    <div class="bg-slate-900 p-6 rounded-xl border border-slate-700">
                        <h4 class="text-xl font-bold text-blue-400 mb-3 border-b border-slate-600 pb-2">2. Switch Multicapa (SVI)</h4>
                        <p class="text-sm mb-4 text-slate-300">Enrutamiento interno por Hardware (ASIC). M√©todo preferido y r√°pido.</p>
                        <ul class="list-disc pl-5 space-y-2 text-sm mb-4">
                            <li>Usa interfaces virtuales <strong>SVI</strong> (ej. <code>interface vlan 10</code>).</li>
                            <li><strong>Comando CR√çTICO:</strong> <code>ip routing</code> (habilita L3).</li>
                            <li>Tambi√©n soporta <strong>Puertos Enrutados</strong> f√≠sicos (<code>no switchport</code>).</li>
                        </ul>
                        <div class="cmd-box">
Switch(config)# ip routing
Switch(config)# interface vlan 10
Switch(config-if)# ip address 192.168.10.1 255.255.255.0
Switch(config-if)# no shutdown
Switch(config-if)# interface vlan 20
Switch(config-if)# ip address 192.168.20.1 255.255.255.0</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- SIMULADOR INFINITO -->
        <section id="simulator" class="mt-20 mb-20">
            <div class="bg-gradient-to-r from-blue-900 to-slate-900 rounded-2xl p-10 shadow-2xl text-center border border-blue-800">
                <h2 class="text-4xl font-black text-white mb-4">üéì SIMULADOR INFINITO 10/10</h2>
                <p class="text-blue-200 mb-8 text-lg">Banco de m√°s de 50 preguntas t√©cnicas. Cada vez que inicies, se generar√° un examen diferente.</p>
                
                <div id="quiz-container" class="bg-white text-slate-900 rounded-xl p-8 max-w-3xl mx-auto text-left shadow-2xl min-h-[400px]">
                    
                    <!-- Pantalla Inicio -->
                    <div id="quiz-start" class="text-center py-10">
                        <div class="text-6xl text-blue-600 mb-6"><i class="fa-solid fa-shuffle"></i></div>
                        <button onclick="startQuiz()" class="bg-blue-600 hover:bg-blue-700 text-white text-xl font-bold py-4 px-12 rounded-full transition shadow-lg hover:shadow-blue-500/50 transform hover:-translate-y-1">
                            GENERAR NUEVO TEST
                        </button>
                        <p class="text-sm text-slate-500 mt-6">Se seleccionar√°n 10 preguntas aleatorias del banco maestro.</p>
                    </div>

                    <!-- Pantalla Pregunta -->
                    <div id="quiz-question" class="hidden">
                        <div class="flex justify-between items-center mb-6 pb-4 border-b border-slate-100">
                            <span class="text-xs font-bold text-slate-400 tracking-widest uppercase bg-slate-100 px-3 py-1 rounded" id="q-topic">TEMA X</span>
                            <span class="text-blue-600 font-bold text-lg" id="q-counter">1/10</span>
                        </div>
                        
                        <h3 class="text-xl font-bold text-slate-800 mb-8 leading-relaxed" id="q-text">...</h3>
                        
                        <div id="q-options" class="space-y-3"></div>

                        <div id="feedback" class="hidden mt-8 p-5 rounded-lg border border-slate-200 bg-slate-50 animation-fade-in">
                            <div class="flex gap-4">
                                <div id="fb-icon" class="text-3xl pt-1"></div>
                                <div>
                                    <h4 id="fb-title" class="font-bold text-lg mb-2"></h4>
                                    <p id="fb-text" class="text-sm text-slate-600 leading-relaxed"></p>
                                </div>
                            </div>
                        </div>

                        <button id="btn-next" onclick="nextQuestion()" class="hidden w-full mt-8 bg-slate-900 hover:bg-black text-white font-bold py-4 rounded-lg transition shadow-lg">Siguiente Pregunta <i class="fa-solid fa-arrow-right ml-2"></i></button>
                    </div>

                    <!-- Pantalla Resultados -->
                    <div id="result-screen" class="hidden text-center py-10">
                        <h3 class="text-3xl font-bold text-slate-800 mb-8">Resultados del Test</h3>
                        <div class="inline-flex items-center justify-center w-40 h-40 rounded-full border-8 border-blue-600 mb-8 bg-blue-50">
                            <span id="score-display" class="text-6xl font-black text-blue-600"></span>
                        </div>
                        <p id="score-msg" class="text-xl text-slate-600 mb-10 font-medium px-8"></p>
                        <button onclick="startQuiz()" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-lg shadow-lg transition">Generar Otro Test Diferente</button>
                    </div>

                </div>
            </div>
        </section>

    </main>

    <script>
        /* --- BANCO DE DATOS MAESTRO (50+ PREGUNTAS) --- */
        const masterQuestionBank = [
            // TEMA 4
            { t: "T4: Jer√°rquicas", q: "¬øCu√°l es la funci√≥n principal de la Capa de N√∫cleo (Core)?", o: ["Aplicar ACLs y filtros", "Conmutar tr√°fico a m√°xima velocidad", "Conectar usuarios finales", "Enrutamiento Inter-VLAN"], c: 1, e: "El N√∫cleo es el backbone. Su √∫nica misi√≥n es velocidad y fiabilidad. No debe hacer tareas de CPU intensivas." },
            { t: "T4: Jer√°rquicas", q: "¬øQu√© t√©rmino define el n√∫mero de dispositivos que un paquete debe cruzar?", o: ["Ancho de banda", "Latencia", "Di√°metro de la red", "Redundancia"], c: 2, e: "El di√°metro de la red mide los saltos. Un dise√±o jer√°rquico busca mantenerlo bajo y predecible." },
            { t: "T4: Jer√°rquicas", q: "¬øEn qu√© capa se aplican t√≠picamente las pol√≠ticas de seguridad (ACLs)?", o: ["Acceso", "Distribuci√≥n", "N√∫cleo", "Internet"], c: 1, e: "La Distribuci√≥n es el punto de agregaci√≥n y control inteligente de la red." },
            { t: "T4: Jer√°rquicas", q: "¬øQu√© tecnolog√≠a se usa para agregar enlaces f√≠sicos en uno l√≥gico?", o: ["STP", "VTP", "EtherChannel", "PoE"], c: 2, e: "EtherChannel combina ancho de banda y provee redundancia en un solo enlace l√≥gico." },
            { t: "T4: Jer√°rquicas", q: "¬øQu√© factor de forma permite unir varios switches f√≠sicos para gestionarlos como uno solo?", o: ["Modular", "Fijo", "Apilable (Stackable)", "Rack"], c: 2, e: "Los switches apilables usan un cable especial (StackWise) para compartir el plano de control." },
            { t: "T4: Jer√°rquicas", q: "¬øQu√© funci√≥n es caracter√≠stica de la Capa de Acceso?", o: ["Enrutamiento OSPF", "Port Security", "Filtrado de rutas", "Conexi√≥n a WAN"], c: 1, e: "La seguridad de puerto se aplica en el borde, donde se conectan los usuarios." },
            { t: "T4: Jer√°rquicas", q: "¬øD√≥nde se debe colocar un servidor que tiene mucho tr√°fico 'Servidor-a-Servidor'?", o: ["En la capa de Acceso", "En el Centro de Datos (N√∫cleo/Distribuci√≥n)", "En la DMZ", "En la capa de Acceso remoto"], c: 1, e: "Los servidores deben agruparse en el bloque de servicios (Data Center) conectado a switches de alta gama." },
            
            // TEMA 5
            { t: "T5: STP", q: "En STP 802.1D, ¬øcu√°l es la duraci√≥n exacta del temporizador 'Max Age'?", o: ["15 s", "2 s", "20 s", "50 s"], c: 2, e: "Max Age es 20s. Forward Delay es 15s. Hello Time es 2s." },
            { t: "T5: STP", q: "¬øQu√© criterio de desempate se usa PRIMERO para elegir el Root Bridge?", o: ["MAC m√°s baja", "Prioridad m√°s baja", "IP m√°s baja", "Mayor uptime"], c: 1, e: "El BID es Prioridad + MAC. Primero se mira la Prioridad. Si empata, la MAC." },
            { t: "T5: STP", q: "¬øCu√°l es el costo IEEE revisado para un enlace de 10 Gbps?", o: ["1", "2", "4", "19"], c: 1, e: "10G=2, 1G=4, 100M=19, 10M=100." },
            { t: "T5: STP", q: "¬øQu√© estado de puerto STP aprende direcciones MAC pero NO env√≠a datos?", o: ["Listening", "Blocking", "Learning", "Forwarding"], c: 2, e: "Learning es el estado de transici√≥n donde se puebla la tabla MAC." },
            { t: "T5: STP", q: "¬øQu√© funci√≥n de Cisco permite a un puerto pasar a Forwarding inmediatamente?", o: ["UplinkFast", "PortFast", "BackboneFast", "BPDU Guard"], c: 1, e: "PortFast salta los estados de escucha/aprendizaje. Solo para puertos de acceso." },
            { t: "T5: STP", q: "¬øCu√°ntos Puertos Ra√≠z (Root Ports) tiene un switch que NO es el Root Bridge?", o: ["Ninguno", "Uno", "Dos", "Uno por VLAN"], c: 1, e: "Cada switch no-ra√≠z elige exactamente UN puerto ra√≠z (el mejor camino hacia el Root)." },
            { t: "T5: STP", q: "¬øCu√°l es el tiempo total de convergencia de STP 802.1D ante un fallo indirecto (Max Age expira)?", o: ["30 s", "50 s", "2 s", "Inmediato"], c: 1, e: "20s (Max Age) + 15s (Listening) + 15s (Learning) = 50 segundos." },
            { t: "T5: STP", q: "¬øQu√© estado de puerto NO existe en RSTP (802.1w)?", o: ["Discarding", "Listening", "Learning", "Forwarding"], c: 1, e: "RSTP combina Blocking, Listening y Disabled en el estado 'Discarding'." },
            { t: "T5: STP", q: "¬øQu√© prioridad por defecto tiene un switch Cisco?", o: ["1", "4096", "32768", "65535"], c: 2, e: "La prioridad base es 32768." },
            
            // TEMA 6
            { t: "T6: VLANs", q: "¬øQu√© valor hexadecimal tiene el TPID de una etiqueta 802.1Q?", o: ["0x8200", "0x8100", "0x0800", "0xAAAA"], c: 1, e: "0x8100 identifica la trama como etiquetada con 802.1Q." },
            { t: "T6: VLANs", q: "¬øQu√© ocurre con el tr√°fico de la VLAN Nativa en un Trunk?", o: ["Se etiqueta con ID 1", "Se bloquea", "Viaja sin etiqueta (untagged)", "Se etiqueta con ID 99"], c: 2, e: "La VLAN Nativa no lleva etiqueta para compatibilidad." },
            { t: "T6: VLANs", q: "¬øD√≥nde se guardan las VLANs de Rango Extendido (1006-4094)?", o: ["vlan.dat", "running-config", "flash memory", "servidor VTP"], c: 1, e: "Las extendidas van en la running-config (NVRAM) y requieren modo Transparente." },
            { t: "T6: VLANs", q: "¬øQu√© tama√±o tiene el campo VLAN ID (VID) en la etiqueta 802.1Q?", o: ["4 bits", "8 bits", "12 bits", "16 bits"], c: 2, e: "12 bits permiten hasta 4096 VLANs." },
            { t: "T6: VLANs", q: "¬øCu√°l es la VLAN predeterminada de todos los puertos en un switch Cisco nuevo?", o: ["VLAN 10", "VLAN 99", "VLAN 1", "Ninguna"], c: 2, e: "Todos los puertos pertenecen a la VLAN 1 por defecto." },
            { t: "T6: VLANs", q: "¬øQu√© campo de la etiqueta 802.1Q se usa para QoS (Prioridad)?", o: ["VID", "CFI", "TPID", "PRI (3 bits)"], c: 3, e: "Los 3 bits de prioridad (802.1p) est√°n en el campo TCI." },
            { t: "T6: VLANs", q: "¬øQu√© requisito es vital para la VLAN de Voz?", o: ["Retardo > 200ms", "Sin QoS", "Retardo < 150ms", "Misma VLAN que datos"], c: 2, e: "La voz es sensible al retardo y requiere menos de 150ms y prioridad alta." },

            // TEMA 7
            { t: "T7: VTP", q: "¬øQu√© hace un cliente VTP si recibe una revisi√≥n mayor a la suya?", o: ["Ignora", "Pasa a Transparente", "Pide actualizaci√≥n (Request)", "Borra su BD"], c: 2, e: "Sabe que est√° desactualizado y pide los datos nuevos." },
            { t: "T7: VTP", q: "¬øD√≥nde guarda la configuraci√≥n un switch VTP Transparente?", o: ["vlan.dat", "running-config", "No guarda", "Servidor"], c: 1, e: "El modo Transparente guarda su configuraci√≥n local en la NVRAM." },
            { t: "T7: VTP", q: "¬øQu√© peligro tiene conectar un switch con Revisi√≥n Alta?", o: ["Ninguno", "Borra las VLANs de la red", "Crea un bucle", "Apaga el dominio"], c: 1, e: "Sobrescribe la base de datos de todos los dem√°s switches." },
            { t: "T7: VTP", q: "¬øQu√© modo VTP permite crear VLANs pero NO las propaga a otros?", o: ["Servidor", "Cliente", "Transparente", "Off"], c: 2, e: "Transparente crea VLANs locales pero no sincroniza su BD con otros." },
            { t: "T7: VTP", q: "¬øQu√© mensaje VTP contiene la lista detallada de VLANs?", o: ["Summary", "Request", "Subset", "Join"], c: 2, e: "El 'Subset Advertisement' lleva los detalles de las VLANs." },
            { t: "T7: VTP", q: "¬øQu√© funci√≥n de VTP ahorra ancho de banda evitando broadcasts innecesarios?", o: ["VTP Snooping", "VTP Pruning", "VTP Version 3", "VTP Guard"], c: 1, e: "VTP Pruning (Poda) corta el tr√°fico hacia switches que no tienen esa VLAN." },
            { t: "T7: VTP", q: "¬øD√≥nde guarda la configuraci√≥n un switch VTP Cliente?", o: ["NVRAM", "Flash", "RAM", "Disco"], c: 2, e: "El cliente no guarda la BD de VLANs permanentemente; la pierde al reiniciar." },

            // TEMA 8
            { t: "T8: Routing", q: "¬øQu√© comando habilita el routing en un Switch L3?", o: ["router rip", "ip routing", "no switchport", "encapsulation dot1q"], c: 1, e: "Sin 'ip routing', el switch act√∫a como L2." },
            { t: "T8: Routing", q: "¬øQu√© se configura en el router para ROAS?", o: ["Interfaces f√≠sicas", "Subinterfaces", "SVIs", "Puertos trunk"], c: 1, e: "Router-on-a-Stick usa subinterfaces (ej. G0/0.10) con encapsulaci√≥n dot1q." },
            { t: "T8: Routing", q: "¬øQu√© es una SVI?", o: ["Switch Virtual Interface", "System Vlan ID", "Spanning Vlan Interface", "Static Virtual IP"], c: 0, e: "Es una interfaz l√≥gica (interface vlan X) para enrutar en switches L3." },
            { t: "T8: Routing", q: "¬øQu√© comando convierte un puerto de switch en un puerto enrutado (L3)?", o: ["ip routing", "switchport mode access", "no switchport", "interface vlan"], c: 2, e: "'no switchport' elimina las funciones de capa 2 del puerto f√≠sico." },
            { t: "T8: Routing", q: "¬øCu√°l es la principal desventaja de Router-on-a-Stick?", o: ["Es caro", "Cuello de botella en el enlace √∫nico", "No soporta VLANs", "Dif√≠cil de configurar"], c: 1, e: "Todo el tr√°fico sube y baja por un solo cable f√≠sico, limitando el rendimiento." },
            { t: "T8: Routing", q: "En ROAS, ¬øqu√© encapsulaci√≥n se debe configurar en la subinterfaz?", o: ["ISL", "Dot1Q", "802.1d", "PPP"], c: 1, e: "encapsulation dot1q <vlan_id> es obligatorio." },
            
            // EXTRAS T√âCNICOS
            { t: "T6: VLANs", q: "Si la VLAN Nativa no coincide en ambos extremos de un trunk, ¬øqu√© error ocurre?", o: ["Loop L2", "Native VLAN Mismatch", "VTP Error", "Port Security Violation"], c: 1, e: "El switch alertar√° de un 'Native VLAN Mismatch' y el tr√°fico puede perderse o mezclarse." },
            { t: "T5: STP", q: "¬øCu√°l es la direcci√≥n MAC destino de una BPDU?", o: ["La del Root Bridge", "La del vecino", "01:80:C2:00:00:00 (Multicast)", "FF:FF:FF:FF:FF:FF"], c: 2, e: "Las BPDUs se env√≠an a una direcci√≥n Multicast reservada para puentes STP." },
            { t: "T6: VLANs", q: "Los IDs de VLAN 1002 a 1005 est√°n reservados para...", o: ["Voz", "Gesti√≥n", "Token Ring y FDDI", "Nativa"], c: 2, e: "Son legados de tecnolog√≠as antiguas y no se pueden borrar." }
        ];

        /* --- MOTOR DEL SIMULADOR --- */
        let currentQuiz = [];
        let currentIndex = 0;
        let score = 0;

        function startQuiz() {
            // 1. Barajar banco completo (Algoritmo Fisher-Yates para aleatoriedad real)
            const shuffled = [...masterQuestionBank];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            
            // 2. Coger 10 preguntas
            currentQuiz = shuffled.slice(0, 10);
            currentIndex = 0;
            score = 0;

            // 3. UI
            document.getElementById('quiz-start').classList.add('hidden');
            document.getElementById('result-screen').classList.add('hidden');
            document.getElementById('quiz-question').classList.remove('hidden');
            loadQuestion();
        }

        function loadQuestion() {
            const q = currentQuiz[currentIndex];
            
            // Textos
            document.getElementById('q-topic').innerText = q.t;
            document.getElementById('q-counter').innerText = `${currentIndex + 1}/10`;
            document.getElementById('q-text').innerText = q.q;
            
            // Reset UI
            const optsContainer = document.getElementById('q-options');
            optsContainer.innerHTML = '';
            document.getElementById('feedback').classList.add('hidden');
            document.getElementById('btn-next').classList.add('hidden');

            // Generar Opciones
            q.o.forEach((opt, idx) => {
                const btn = document.createElement('button');
                btn.className = 'option-btn';
                btn.innerHTML = `<span class="font-bold mr-3 text-blue-500">${String.fromCharCode(65+idx)}.</span> ${opt}`;
                btn.onclick = () => checkAnswer(idx, btn, q);
                optsContainer.appendChild(btn);
            });
        }

        function checkAnswer(selectedIdx, btn, qData) {
            // Bloquear botones
            const buttons = document.querySelectorAll('.option-btn');
            buttons.forEach(b => b.disabled = true);

            const isCorrect = selectedIdx === qData.c;
            const feedbackEl = document.getElementById('feedback');
            const fbIcon = document.getElementById('fb-icon');
            const fbTitle = document.getElementById('fb-title');
            
            if (isCorrect) {
                score++;
                btn.classList.add('correct');
                fbIcon.innerHTML = '<i class="fa-solid fa-circle-check text-green-500"></i>';
                fbTitle.innerText = "¬°CORRECTO!";
                fbTitle.className = "font-bold text-lg mb-1 text-green-600";
                feedbackEl.className = "mt-6 p-5 rounded-xl border border-green-200 bg-green-50 block shadow-sm";
            } else {
                btn.classList.add('incorrect');
                // Mostrar la correcta
                buttons[qData.c].classList.add('correct');
                fbIcon.innerHTML = '<i class="fa-solid fa-circle-xmark text-red-500"></i>';
                fbTitle.innerText = "INCORRECTO";
                fbTitle.className = "font-bold text-lg mb-1 text-red-600";
                feedbackEl.className = "mt-6 p-5 rounded-xl border border-red-200 bg-red-50 block shadow-sm";
            }

            document.getElementById('fb-text').innerText = qData.e;
            document.getElementById('btn-next').classList.remove('hidden');
        }

        function nextQuestion() {
            currentIndex++;
            if (currentIndex < currentQuiz.length) {
                loadQuestion();
            } else {
                showResults();
            }
        }

        function showResults() {
            document.getElementById('quiz-question').classList.add('hidden');
            document.getElementById('result-screen').classList.remove('hidden');
            
            const scoreDisplay = document.getElementById('score-display');
            scoreDisplay.innerText = `${score}/10`;
            
            let msg = "";
            if(score === 10) msg = "¬°INCRE√çBLE! üèÜ Nivel Experto Desbloqueado.";
            else if(score >= 9) msg = "¬°Excelente! Casi perfecto.";
            else if(score >= 7) msg = "Buen trabajo. Repasa los fallos puntuales.";
            else if(score >= 5) msg = "Aprobado justo. Necesitas repasar la teor√≠a.";
            else msg = "No te rindas. Vuelve a leer la gu√≠a y reint√©ntalo.";
            
            document.getElementById('score-msg').innerText = msg;
        }
    </script>
</body>
</html>
